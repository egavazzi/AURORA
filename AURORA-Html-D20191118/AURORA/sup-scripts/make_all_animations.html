<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of make_all_animations</title>
  <meta name="keywords" content="make_all_animations">
  <meta name="description" content="% Make all animations-script">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html sup-scripts -->
<h1>make_all_animations
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>% Make all animations-script</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Make all animations-script
 This script attempts to produce 4 animations per
 results-directory, 3 with plane-cuts through the z-t-E
 electron-flux array for each pitch-angle-stream and one with
 pitch-angle-spectra at four altitudes.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/Plotting/animate_IeztE_3DEzoft.html" class="code" title="function output = animate_IeztE_3DEzoft(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DEzoft</a>	animate_IeztE_3DtzofE - animation of time-varying electron flux</li><li><a href="../../AURORA/Plotting/animate_IeztE_3DtEofz.html" class="code" title="function output = animate_IeztE_3DtEofz(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DtEofz</a>	animate_IeEztE_3DtzofE - animation of time-varying electron energy flux</li><li><a href="../../AURORA/Plotting/animate_IeztE_3DtzofE.html" class="code" title="function output = animate_IeztE_3DtzofE(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DtzofE</a>	animate_IeztE_3DtzofE - animation of time-varying electron flux</li><li><a href="../../AURORA/Plotting/animate_IeztE_pitchangleflux.html" class="code" title="function output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut,cxin)">animate_IeztE_pitchangleflux</a>	animate_IeztE_pitchangleflux - animation of time-varying electron energy flux</li><li><a href="../../AURORA/utilities/Ie_ztE_loader.html" class="code" title="function [t,h_atm,E,mu_lims,IeZTE,mu_scatterings] = Ie_ztE_loader(data_paths,ops)">Ie_ztE_loader</a>	Ie_ztE_loader reads flickering-aurora data from the</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%% Make all animations-script</span>
0002 <span class="comment">% This script attempts to produce 4 animations per</span>
0003 <span class="comment">% results-directory, 3 with plane-cuts through the z-t-E</span>
0004 <span class="comment">% electron-flux array for each pitch-angle-stream and one with</span>
0005 <span class="comment">% pitch-angle-spectra at four altitudes.</span>
0006 
0007 <span class="comment">%% Intensity-limits.</span>
0008 <span class="comment">%  To make it possible or easy to have consistent intensity-limits</span>
0009 <span class="comment">%  across multiple result-files there is currently no automatic</span>
0010 <span class="comment">%  intensity-limits set in this script. This means that an array</span>
0011 <span class="comment">%  for the colour-limits, cxmax has to be generated manually.</span>
0012 
0013 <span class="comment">%% Root result-directories</span>
0014 <span class="keyword">if</span> ~exist(<span class="string">'results_dir'</span>,<span class="string">'var'</span>) || isempty(results_dir)
0015   results_dir = <span class="string">'/media/bgu001/5f5e8978-a828-4fd4-aabf-2032a3fb895b/Data/Bjorns-panic-repository/Etrp-tdms'</span>;
0016 <span class="keyword">end</span>
0017 
0018 <span class="comment">%% Run-directories:</span>
0019 <span class="keyword">if</span> ~exist(<span class="string">'RunDirs'</span>,<span class="string">'var'</span>) || isempty(RunDirs)
0020   RunDirs = {<span class="string">'Run_PnL20190828'</span>;
0021              <span class="string">'Run_AWA20190920'</span>;
0022              <span class="string">'Run_PnL20190916'</span>;
0023              <span class="string">'Run_PnL20191018'</span>};
0024 <span class="keyword">end</span>
0025 
0026 
0027 <span class="comment">%% This sub-plot layout might need to be modified to adapt to layouts</span>
0028 <span class="comment">% more suitable to other pitch-angle-stream configurations:</span>
0029 spp = [2*ones(10,1),5*ones(10,1),[1:5,(10:-1:6)]'];
0030 
0031 <span class="comment">%% These figure-sizes might need to be modified to adapt to other</span>
0032 <span class="comment">%pitch-angle-stream configurations too.</span>
0033 figPwide = [692, 556, 997, 418];   <span class="comment">% trying this one for 10-beam calculations</span>
0034 figPsquare = [1021, 421, 668, 553];<span class="comment">% trying this one for 9-beam</span>
0035                                    <span class="comment">% calculations and for</span>
0036                                    <span class="comment">% pitch-angle animation</span>
0037 fig_sz = figPwide;
0038 
0039 
0040 figure
0041 whitebg([1 1 1])
0042 
0043 
0044 <span class="comment">%% Loop away!</span>
0045 <span class="keyword">for</span> i2 = 1:numel(RunDirs)
0046   cd(results_dir)
0047   cd(RunDirs{i2})
0048   dDir = dir;
0049   
0050   <span class="comment">% Variable for diagnostics</span>
0051   iFaulties = 1;
0052   <span class="comment">%# cxmax = 12*ones(numel(dDir),2);</span>
0053   <span class="keyword">for</span> iRF = 3:numel(dDir)
0054     cd(results_dir)
0055     cd(RunDirs{i2})
0056     <span class="keyword">if</span> dDir(iRF).isdir
0057       <span class="keyword">try</span>
0058         <span class="comment">% loading the electron-transport results</span>
0059         [t,h_atm,E,mu_lims,IeZTE,mu_scatterings] = <a href="../../AURORA/utilities/Ie_ztE_loader.html" class="code" title="function [t,h_atm,E,mu_lims,IeZTE,mu_scatterings] = Ie_ztE_loader(data_paths,ops)">Ie_ztE_loader</a>({dDir(iRF).name});
0060         dE = diff(E);dE(end+1) = dE(end);
0061         BeamW = 2*pi*mu_scatterings{3};
0062         <span class="keyword">for</span> i1 = numel(BeamW):-1:1,
0063           theta_str{i1} = sprintf(<span class="string">'%3.1f - %3.1f'</span>,<span class="keyword">...</span>
0064                                   180-180/pi*acos(mu_lims(i1)),<span class="keyword">...</span>
0065                                   180-180/pi*acos(mu_lims(i1+1)));
0066         <span class="keyword">end</span>
0067         filename = fullfile(dDir(iRF).name,<span class="string">'IeztE_3DEzoft.avi'</span>);
0068         
0069         <span class="keyword">try</span>
0070           <span class="comment">% Producing the first animation with subplots for energy</span>
0071           <span class="comment">% (x) - altitude (y) with time-variation</span>
0072           colormap(jet)
0073           set(gcf,<span class="string">'position'</span>,fig_sz)
0074           <a href="../../AURORA/Plotting/animate_IeztE_3DEzoft.html" class="code" title="function output = animate_IeztE_3DEzoft(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DEzoft</a>(t,h_atm,E(1:size(IeZTE,3)),<span class="keyword">...</span>
0075                                 IeZTE,<span class="keyword">...</span>
0076                                 dE(1:size(IeZTE,3)),BeamW,<span class="keyword">...</span>
0077                                 [-5 0]+max(cxmax(min(<span class="keyword">end</span>,iRF),:)),spp, theta_str,filename);
0078         <span class="keyword">catch</span>
0079           ERR_MSG{iFaulties} = lasterr;
0080           disp([<span class="string">'something wrong with doing: '</span>,filename])
0081           Faulties{iFaulties} = filename;
0082           iFaulties = iFaulties + 1;
0083         <span class="keyword">end</span>
0084         <span class="keyword">try</span>
0085           <span class="comment">% Producing the second animation with subplots for energy</span>
0086           <span class="comment">% (x) - altitude (y) with energy-variation</span>
0087           filename = fullfile(dDir(iRF).name,<span class="string">'IeztE_3DtzofE.avi'</span>);
0088           set(gcf,<span class="string">'position'</span>,fig_sz)
0089           <a href="../../AURORA/Plotting/animate_IeztE_3DtzofE.html" class="code" title="function output = animate_IeztE_3DtzofE(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DtzofE</a>(t,h_atm,E(1:size(IeZTE,3)),<span class="keyword">...</span>
0090                                 IeZTE,<span class="keyword">...</span>
0091                                 dE(1:size(IeZTE,3)),BeamW,<span class="keyword">...</span>
0092                                 [-5 0]+max(cxmax(min(<span class="keyword">end</span>,iRF),:)),spp, theta_str,filename);
0093         <span class="keyword">catch</span>
0094           ERR_MSG{iFaulties} = lasterr;
0095           disp([<span class="string">'something wrong with doing: '</span>,filename])
0096           Faulties{iFaulties} = filename;
0097           iFaulties = iFaulties + 1;
0098         <span class="keyword">end</span>
0099         <span class="keyword">try</span>
0100           <span class="comment">% Producing the third animation with subplots for time</span>
0101           <span class="comment">% (x) - Energy (y) with altitude-variation</span>
0102           filename = fullfile(dDir(iRF).name,<span class="string">'IeztE_3DtEofz.avi'</span>);
0103           set(gcf,<span class="string">'position'</span>,fig_sz)
0104           <a href="../../AURORA/Plotting/animate_IeztE_3DtEofz.html" class="code" title="function output = animate_IeztE_3DtEofz(t,h_atm,E,Ie_ztE,dE,BeamSA,cx_lims,spp, theta_strs,movieOut)">animate_IeztE_3DtEofz</a>(t,h_atm,E(1:size(IeZTE,3)),<span class="keyword">...</span>
0105                                 IeZTE,<span class="keyword">...</span>
0106                                 dE(1:size(IeZTE,3)),BeamW,<span class="keyword">...</span>
0107                                 [-5 0]+max(cxmax(min(<span class="keyword">end</span>,iRF),:)),spp, theta_str,filename);
0108         <span class="keyword">catch</span>
0109           ERR_MSG{iFaulties} = lasterr;
0110           disp([<span class="string">'something wrong with doing: '</span>,filename])
0111           Faulties{iFaulties} = filename;
0112           iFaulties = iFaulties + 1;
0113         <span class="keyword">end</span>
0114         <span class="keyword">try</span>
0115           <span class="comment">% Producing the fourth animation with pitch-angle</span>
0116           <span class="comment">% distribution at four heights</span>
0117           filename = fullfile(dDir(iRF).name,<span class="string">'IeztE_pitchangledist.avi'</span>);
0118           [dh,i115] = min(abs(h_atm/1e3-225));
0119           [dh,i175] = min(abs(h_atm/1e3-325));
0120           [dh,i300] = min(abs(h_atm/1e3-450));
0121           [dh,i600] = min(abs(h_atm/1e3-600));
0122           iZ = [i115,i175,i300,i600]
0123           set(gcf,<span class="string">'position'</span>,figPsquare)
0124           <a href="../../AURORA/Plotting/animate_IeztE_pitchangleflux.html" class="code" title="function output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut,cxin)">animate_IeztE_pitchangleflux</a>(t,h_atm/1e3,<span class="keyword">...</span>
0125                                        E,dE,<span class="keyword">...</span>
0126                                        IeZTE,<span class="keyword">...</span>
0127                                        BeamW,mu_lims,<span class="keyword">...</span>
0128                                        iZ,<span class="keyword">...</span>
0129                                        filename,<span class="keyword">...</span>
0130                                        [-3.5 0]+max(cxmax(min(<span class="keyword">end</span>,iRF),:)))
0131         <span class="keyword">catch</span>
0132           ERR_MSG{iFaulties} = lasterr;
0133           disp([<span class="string">'something wrong with doing: '</span>,filename])
0134           Faulties{iFaulties} = filename;
0135           iFaulties = iFaulties + 1;
0136         <span class="keyword">end</span>
0137       <span class="keyword">catch</span>
0138         ERR_MSG{iFaulties} = lasterr;
0139         disp([<span class="string">'something wrong with processing directory: '</span>,dDir(iRF).name])
0140         Faulties{iFaulties} = dDir(iRF).name;
0141         iFaulties = iFaulties + 1;
0142       <span class="keyword">end</span>
0143     <span class="keyword">end</span>
0144   <span class="keyword">end</span>
0145 <span class="keyword">end</span>
0146 
0147 
0148 <span class="comment">%   Copyright � 2019 Bjorn Gustavsson, &lt;bjorn.gustavsson@irf.se&gt;</span>
0149 <span class="comment">%   This is free software, licensed under GNU GPL version 2 or later</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>