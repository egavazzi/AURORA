<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of combine_n_extract_I_dt_Mm5</title>
  <meta name="keywords" content="combine_n_extract_I_dt_Mm5">
  <meta name="description" content="% Collect all optical emissions and the input parameters">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html sup-scripts -->
<h1>combine_n_extract_I_dt_Mm5
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>% Collect all optical emissions and the input parameters</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [All_I_lambda,It_Mm] = combine_n_extract_I_dt_Mm5(root_dir,RunDirs) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">% Collect all optical emissions and the input parameters
  Produce plots of Intensity Modulation and time-shifts as
  function of peak Energy, flickering-frequency, source altitude,
  Excitation threshold. 
  
  This function is a glorified script that uses hard-coded paths
  to the data directories and loops through all result-directories
  looking for files with time-variations of column-rates of
  optical emissions and excitation-rates. 
 
 Calling:
  [All_I_lambda,It_Mm] = combine_n_extract_I_dt_Mm5(root_dir,RunDirs)
 Input:
  root_dir - Full path to root-directoty of the Runs-directories
             (Optional argument, defaults to:
             '/media/bgu001/5f5e8978-a828-4fd4-aabf-2032a3fb895b/Data/Bjorns-panic-repository/Etrp-tdms';) 
  RunDirs  - Cell-array of Runs-directories where all
             results-directories from the time-dependent
             electron-transport calculations are stored (Optional
             argument, defaults to: {'Run_PnL20190828'})
 Output:
  All_I_lambda - cell-array with cell-arrays of all time-series of
                 column emission-rates, sorted in columns as:
                 all_I4278,all_I6730,all_I7774,...
                 all_I8446,all_IO1S,all_IO1D,...
                 all_I7774_O,all_I7774_O2,...
                 all_I8446_O,all_I8446_O2};
 It_Mm         - Cell-array with the intensity maxima and minima
                 and the corresponding timing. First column
                 contains directory-name, and string-headings for
                 the rows ('I_max', 'I_min', 't_max','t_min'). The
                 first row contains, dir-name, and
                 wavelengths. The rest of the cell-array contains
                 arrays with the corresponding parameters.
 
 The script produces plots of:
  IMA and dt as function peak Energy of FABs plotted in subplots
  for flickering_frequency for source altitude at 3000 km 

  IMA and dt as function flickering_frequency in subplots for 
  peak energy of FABs for source altitude at 3000 km
 
  IMA and as a function of pitch-angle width and source altitude

  IMA as a function of excitation threshold
 
  dtmax as a function of excitation threshold</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>	1     2        3     4         5    6      7    8    9   10   11,   12,</li><li><a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>	E_LEVELSONN2 - wavelength and enegy of 6 states in O and N2</li><li><a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>	DT_AVGSTD - average (and std) of difference between times in unsynchronised</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)</a></li><li><a href="#_sub2" class="code">function plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [All_I_lambda,It_Mm] = combine_n_extract_I_dt_Mm5(root_dir,RunDirs)</a>
0002 <span class="comment">%% Collect all optical emissions and the input parameters</span>
0003 <span class="comment">%  Produce plots of Intensity Modulation and time-shifts as</span>
0004 <span class="comment">%  function of peak Energy, flickering-frequency, source altitude,</span>
0005 <span class="comment">%  Excitation threshold.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%  This function is a glorified script that uses hard-coded paths</span>
0008 <span class="comment">%  to the data directories and loops through all result-directories</span>
0009 <span class="comment">%  looking for files with time-variations of column-rates of</span>
0010 <span class="comment">%  optical emissions and excitation-rates.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Calling:</span>
0013 <span class="comment">%  [All_I_lambda,It_Mm] = combine_n_extract_I_dt_Mm5(root_dir,RunDirs)</span>
0014 <span class="comment">% Input:</span>
0015 <span class="comment">%  root_dir - Full path to root-directoty of the Runs-directories</span>
0016 <span class="comment">%             (Optional argument, defaults to:</span>
0017 <span class="comment">%             '/media/bgu001/5f5e8978-a828-4fd4-aabf-2032a3fb895b/Data/Bjorns-panic-repository/Etrp-tdms';)</span>
0018 <span class="comment">%  RunDirs  - Cell-array of Runs-directories where all</span>
0019 <span class="comment">%             results-directories from the time-dependent</span>
0020 <span class="comment">%             electron-transport calculations are stored (Optional</span>
0021 <span class="comment">%             argument, defaults to: {'Run_PnL20190828'})</span>
0022 <span class="comment">% Output:</span>
0023 <span class="comment">%  All_I_lambda - cell-array with cell-arrays of all time-series of</span>
0024 <span class="comment">%                 column emission-rates, sorted in columns as:</span>
0025 <span class="comment">%                 all_I4278,all_I6730,all_I7774,...</span>
0026 <span class="comment">%                 all_I8446,all_IO1S,all_IO1D,...</span>
0027 <span class="comment">%                 all_I7774_O,all_I7774_O2,...</span>
0028 <span class="comment">%                 all_I8446_O,all_I8446_O2};</span>
0029 <span class="comment">% It_Mm         - Cell-array with the intensity maxima and minima</span>
0030 <span class="comment">%                 and the corresponding timing. First column</span>
0031 <span class="comment">%                 contains directory-name, and string-headings for</span>
0032 <span class="comment">%                 the rows ('I_max', 'I_min', 't_max','t_min'). The</span>
0033 <span class="comment">%                 first row contains, dir-name, and</span>
0034 <span class="comment">%                 wavelengths. The rest of the cell-array contains</span>
0035 <span class="comment">%                 arrays with the corresponding parameters.</span>
0036 <span class="comment">%</span>
0037 <span class="comment">% The script produces plots of:</span>
0038 <span class="comment">%  IMA and dt as function peak Energy of FABs plotted in subplots</span>
0039 <span class="comment">%  for flickering_frequency for source altitude at 3000 km</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%  IMA and dt as function flickering_frequency in subplots for</span>
0042 <span class="comment">%  peak energy of FABs for source altitude at 3000 km</span>
0043 <span class="comment">%</span>
0044 <span class="comment">%  IMA and as a function of pitch-angle width and source altitude</span>
0045 <span class="comment">%</span>
0046 <span class="comment">%  IMA as a function of excitation threshold</span>
0047 <span class="comment">%</span>
0048 <span class="comment">%  dtmax as a function of excitation threshold</span>
0049 
0050 <span class="comment">%% This is a behemot of a function-script</span>
0051 <span class="comment">% Therefore this is the contents section</span>
0052 <span class="comment">%       Lines   Section</span>
0053 <span class="comment">% *   67 -   95 Settings etc</span>
0054 <span class="comment">% *   97 -  353 Data-reading and processing</span>
0055 <span class="comment">% *  355 -  381 Load run-parameters-settings</span>
0056 <span class="comment">% *  383 -  594 Sub-set identification</span>
0057 <span class="comment">% *  597 -  820 Figure 1</span>
0058 <span class="comment">% *  823 - 1047 Figure 2</span>
0059 <span class="comment">% * 1049 - 1143 Figure 3</span>
0060 <span class="comment">% * 1145 - 1185 Figure 4</span>
0061 <span class="comment">% * 1188 - 1241 Figure 5</span>
0062 <span class="comment">% * 1243 - 1269 sub-functions</span>
0063 
0064 <span class="comment">%   Copyright ï¿½ 2019 Bjorn Gustavsson, &lt;bjorn.gustavsson@irf.se&gt;</span>
0065 <span class="comment">%   This is free software, licensed under GNU GPL version 2 or later</span>
0066 
0067 <span class="comment">%% Base-directory of result-data</span>
0068 <span class="comment">%  This separation makes it easy to have result-directories from</span>
0069 <span class="comment">%  different runs in different subdirectories and merge the results</span>
0070 <span class="comment">%  here</span>
0071 <span class="keyword">if</span> nargin == &lt; 1 || isempty(root_dir)
0072   root_dir = <span class="string">'/media/bgu001/5f5e8978-a828-4fd4-aabf-2032a3fb895b/Data/Bjorns-panic-repository/Etrp-tdms'</span>;
0073 <span class="keyword">end</span>
0074 <span class="comment">%% Default results-directories.</span>
0075 <span class="keyword">if</span> nargin &lt; 2 || isempty(RunDirs)
0076   RunDirs = {<span class="string">'Run_PnL20190828'</span>};
0077 <span class="keyword">end</span>
0078 
0079 <span class="comment">%% Settings for data-reading phase:</span>
0080 plot_n_check = 1;         <span class="comment">% Plot time-series of intensities</span>
0081 plot_n_check_pause = 0.1; <span class="comment">% dwell-time</span>
0082 
0083 <span class="comment">%% Plot-settings for results-plots</span>
0084 disp_n_wait = 0.5;
0085 ftsza = 11;
0086 ftszLT = 15;
0087 clrs_BRrK = {[0 0 1],[1 0 0],[.6 0 0],[0 0 0]};
0088 <span class="comment">%% axis-limits for the different plots</span>
0089 ax_ff_IMA     = [3  12 0 0.9]; <span class="comment">% [3 12 0 1.05];</span>
0090 ax_Ef_IMA     = [2   9 0 0.9]; <span class="comment">% [2  9 0 1.05];</span>
0091 ax_dtheta_IMA = [0  70 0 0.9]; <span class="comment">% [0 16 0 1.05];</span>
0092 ax_ExcT_IMA   = [0  20 0 0.9]; 
0093 ax_ExcT_dt    = [0  20 0 30]; 
0094 ax_z0_IMA     = [1500 4500 0 0.9];
0095 
0096 ax_ff_dt     = [3  12 -1 22];
0097 ax_Ef_dt     = [2   9 -1 22];
0098 ax_dtheta_dt = [0 100 -1 22];
0099 
0100 <span class="comment">%% Reading the time-series of column-intensities</span>
0101 CP = {};
0102 iIdt = 1;
0103 <span class="keyword">for</span> i2 = 1:numel(RunDirs)
0104   cd(root_dir)
0105   cd(RunDirs{i2})
0106   dDir = dir;            <span class="comment">% Move into the Run-dirs</span>
0107   <span class="keyword">for</span> i1 = 3:numel(dDir)
0108     cd(root_dir)
0109     cd(RunDirs{i2})
0110     <span class="keyword">if</span> dDir(i1).isdir
0111       cd(dDir(i1).name) <span class="comment">% In each Run-dir move into the data-dirs</span>
0112       <span class="keyword">try</span>
0113         load curr_par.mat curr_par <span class="comment">% Load parameters for the current run</span>
0114         CP(iIdt,:) = curr_par(:); <span class="comment">%#ok&lt;*AGROW&gt;</span>
0115         <span class="comment">% Load time-series of column-intensities</span>
0116         load I_lambda_of_t.mat t I_4278 I_6730 I_7774 I_8446 I_O1D I_7774_O2 I_8446_O2 I_O1S I_7774_O I_8446_O
0117         all_I4278{iIdt} = I_4278;
0118         all_I6730{iIdt} = I_6730;
0119         all_I7774{iIdt} = I_7774;
0120         all_I8446{iIdt} = I_8446;
0121         all_I7774_O{iIdt} = I_7774_O;
0122         all_I8446_O{iIdt} = I_8446_O;
0123         all_I7774_O2{iIdt} = I_7774_O2;
0124         all_I8446_O2{iIdt} = I_8446_O2;
0125         all_IO1S{iIdt} = I_O1S;
0126         all_IO1D{iIdt} = I_O1D;
0127         
0128         <span class="comment">%% Identify local maxima and minima</span>
0129         <span class="comment">%% 4278</span>
0130         [t4278M,I4278M,t4278m,I4278m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_4278);
0131         <span class="comment">%% 6730</span>
0132         [t6730M,I6730M,t6730m,I6730m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_6730);
0133         <span class="comment">%% 7774</span>
0134         [t7774M,I7774M,t7774m,I7774m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_7774);
0135         <span class="comment">%% 8446</span>
0136         [t8446M,I8446M,t8446m,I8446m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_8446);
0137         <span class="comment">%% 7774_O</span>
0138         [t7774_OM,I7774_OM,t7774_Om,I7774_Om] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_7774_O);
0139         <span class="comment">%% 8446_O</span>
0140         [t8446_OM,I8446_OM,t8446_Om,I8446_Om] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_8446_O);
0141         <span class="comment">%% 7774_O2</span>
0142         [t7774_O2M,I7774_O2M,t7774_O2m,I7774_O2m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_7774_O2);
0143         <span class="comment">%% 8446_O2</span>
0144         [t8446_O2M,I8446_O2M,t8446_O2m,I8446_O2m] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_8446_O2);
0145         <span class="comment">%% O1S</span>
0146         [tO1SM,IO1SM,tO1Sm,IO1Sm] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_O1S);
0147         <span class="comment">%% O1D</span>
0148         [tO1DM,IO1DM,tO1Dm,IO1Dm] = <a href="#_sub1" class="code" title="subfunction [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)">local_minMaxFinder</a>(t,I_O1D);
0149         
0150         par_n_run = [dDir(i1).name,<span class="string">'-'</span>,RunDirs{i2}];
0151         <span class="keyword">if</span> plot_n_check  <span class="comment">% Then we plot the time-series with minima</span>
0152                          <span class="comment">% and MAXIMA marked</span>
0153           clf
0154           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_4278,t4278M,I4278M,t4278m,I4278m,1,<span class="string">'4278 A'</span>,[.1 0 1])
0155           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_6730,t6730M,I6730M,t6730m,I6730m,2,<span class="string">'6730 A'</span>,[.8 0 0])
0156           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_7774,t7774M,I7774M,t7774m,I7774m,3,<span class="string">'7774 A'</span>,[.5 0 0])
0157           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_8446,t8446M,I8446M,t8446m,I8446m,4,<span class="string">'8446 A'</span>,[.1 0 0])
0158           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_O1S,tO1SM,IO1SM,tO1Sm,IO1Sm,5,<span class="string">'O1S'</span>,[0 1 0])
0159           <a href="#_sub2" class="code" title="subfunction plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)">plot_ItMm</a>(t,I_O1D,tO1DM,IO1DM,tO1Dm,IO1Dm,6,<span class="string">'O1D'</span>,[1 0 0])
0160           
0161           xlabel(par_n_run),ylabel(iIdt),title(i1)
0162           pause(plot_n_check_pause)
0163         <span class="keyword">end</span>
0164         <span class="comment">% Save away the extreme-values and the time of them for</span>
0165         <span class="comment">% each data-directory</span>
0166         <span class="comment">%                1           2      3      4      5      6    7        8         9       10        11</span>
0167         It_Mm{iIdt} = {par_n_run, 4278,  6730,  7774,  8446, 5577, 6300, 7774.01   7774.02  8446.01   8446.02
0168                       <span class="string">'t_MAX'</span>,  t4278M,t6730M,t7774M,t8446M,tO1SM,tO1DM,t7774_OM,t7774_O2M,t8446_OM,t8446_O2M
0169                       <span class="string">'t_min'</span>,  t4278m,t6730m,t7774m,t8446m,tO1Sm,tO1Dm,t7774_Om,t7774_O2m,t8446_Om,t8446_O2m
0170                       <span class="string">'I_MAX'</span>,  I4278M,I6730M,I7774M,I8446M,IO1SM,IO1DM,I7774_OM,I7774_O2M,I8446_OM,I8446_O2M
0171                       <span class="string">'I_min'</span>,  I4278m,I6730m,I7774m,I8446m,IO1Sm,IO1Dm,I7774_Om,I7774_O2m,I8446_Om,I8446_O2m };
0172         fprintf(<span class="string">'===&gt;&gt;&gt; this went OK for %s\n'</span>,pwd)
0173         iIdt = iIdt + 1;
0174       <span class="keyword">catch</span>
0175         fprintf(<span class="string">'Everythings not right in directory: %s\n'</span>,pwd)
0176       <span class="keyword">end</span>
0177     <span class="keyword">end</span>
0178   <span class="keyword">end</span>
0179 <span class="keyword">end</span>
0180 All_I_lambda = {all_I4278,all_I6730,all_I7774,<span class="keyword">...</span>
0181                 all_I8446,all_IO1S,all_IO1D,<span class="keyword">...</span>
0182                 all_I7774_O,all_I7774_O2,<span class="keyword">...</span>
0183                 all_I8446_O,all_I8446_O2};
0184 
0185 <span class="comment">%% Calculate time-shifts between local peaks of the</span>
0186 <span class="comment">%  intensities in different wavelengths</span>
0187 idx_r_Tmax = 2;
0188 idx_r_Tmin = 3;
0189 <span class="keyword">for</span> i1 = numel(It_Mm):-1:1
0190   <span class="comment">%try</span>
0191     idxM = 2:numel(It_Mm{i1}{idx_r_Tmax,2}(1:end-1));
0192     <span class="keyword">if</span> numel(idxM) &lt; 2
0193       idxM = [idxM,idxM+1];
0194     <span class="keyword">end</span>
0195     tMax4278 = It_Mm{i1}{idx_r_Tmax,2};<span class="comment">%(idxM);</span>
0196     tMax6730 = It_Mm{i1}{idx_r_Tmax,3};<span class="comment">%(idxM);</span>
0197     tMax7774 = It_Mm{i1}{idx_r_Tmax,4};<span class="comment">%(idxM);</span>
0198     tMax8446 = It_Mm{i1}{idx_r_Tmax,5};<span class="comment">%(idxM);</span>
0199     tMaxO1S  = It_Mm{i1}{idx_r_Tmax,6};<span class="comment">%(idxM);</span>
0200     tMaxO1D  = It_Mm{i1}{idx_r_Tmax,7};<span class="comment">%(idxM);</span>
0201     tMax7774O = It_Mm{i1}{idx_r_Tmax,8};<span class="comment">%(idxM);</span>
0202     tMax7774O2 = It_Mm{i1}{idx_r_Tmax,9};<span class="comment">%(idxM);</span>
0203     tMax8446O = It_Mm{i1}{idx_r_Tmax,10};<span class="comment">%(idxM);</span>
0204     tMax8446O2 = It_Mm{i1}{idx_r_Tmax,11};<span class="comment">%(idxM);</span>
0205     <span class="comment">% 6730 - 4278</span>
0206     [dtmax(i1,1),stdtmax(i1,1),dTmax{i1,1}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax6730(2:end-1));
0207     [dtmax(i1,2),stdtmax(i1,2),dTmax{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax7774(2:end-1));
0208     [dtmax(i1,3),stdtmax(i1,3),dTmax{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax8446(2:end-1));
0209     [dtmax(i1,4),stdtmax(i1,4),dTmax{i1,4}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMaxO1S(2:end-1));
0210     [dtmax(i1,5),stdtmax(i1,5),dTmax{i1,5}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMaxO1D(2:end-1));
0211     
0212     [dtmax(i1,6),stdtmax(i1,2),dTmax{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax7774O(2:end-1));
0213     [dtmax(i1,7),stdtmax(i1,2),dTmax{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax7774O2(2:end-1));
0214     
0215     [dtmax(i1,8),stdtmax(i1,3),dTmax{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax8446O(2:end-1));
0216     [dtmax(i1,9),stdtmax(i1,3),dTmax{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tMax4278(2:end-1),tMax8446O2(2:end-1));
0217     
0218 <span class="keyword">end</span>
0219 <span class="comment">%% Calculate time-shifts between local valeys of the</span>
0220 <span class="comment">%  intensities in different wavelengths</span>
0221 <span class="keyword">for</span> i1 = numel(It_Mm):-1:1
0222   <span class="comment">%try</span>
0223     idxM = 2:numel(It_Mm{i1}{idx_r_Tmax,2}(1:end-1));
0224     <span class="keyword">if</span> numel(idxM) &lt; 2
0225       idxM = [idxM,idxM+1];
0226     <span class="keyword">end</span>
0227     tmin4278 = It_Mm{i1}{idx_r_Tmin,2};<span class="comment">%(idxM);</span>
0228     tmin6730 = It_Mm{i1}{idx_r_Tmin,3};<span class="comment">%(idxM);</span>
0229     tmin7774 = It_Mm{i1}{idx_r_Tmin,4};<span class="comment">%(idxM);</span>
0230     tmin8446 = It_Mm{i1}{idx_r_Tmin,5};<span class="comment">%(idxM);</span>
0231     tminO1S  = It_Mm{i1}{idx_r_Tmin,6};<span class="comment">%(idxM);</span>
0232     tminO1D  = It_Mm{i1}{idx_r_Tmin,7};<span class="comment">%(idxM);</span>
0233     tmin7774O = It_Mm{i1}{idx_r_Tmin,8};<span class="comment">%(idxM);</span>
0234     tmin7774O2 = It_Mm{i1}{idx_r_Tmin,9};<span class="comment">%(idxM);</span>
0235     tmin8446O = It_Mm{i1}{idx_r_Tmin,10};<span class="comment">%(idxM);</span>
0236     tmin8446O2 = It_Mm{i1}{idx_r_Tmin,11};<span class="comment">%(idxM);</span>
0237     
0238     [dtmin(i1,1),stdtmin(i1,1),dTmin{i1,1}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin6730(2:end-1));
0239     [dtmin(i1,2),stdtmin(i1,2),dTmin{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin7774(2:end-1));
0240     [dtmin(i1,3),stdtmin(i1,3),dTmin{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin8446(2:end-1));
0241     [dtmin(i1,4),stdtmin(i1,4),dTmin{i1,4}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tminO1S(2:end-1));
0242     [dtmin(i1,5),stdtmin(i1,5),dTmin{i1,5}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tminO1D(2:end-1));
0243     
0244     [dtmin(i1,6),stdtmin(i1,2),dTmin{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin7774O(2:end-1));
0245     [dtmin(i1,7),stdtmin(i1,2),dTmin{i1,2}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin7774O2(2:end-1));
0246     
0247     [dtmin(i1,8),stdtmin(i1,3),dTmin{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin8446O(2:end-1));
0248     [dtmin(i1,9),stdtmin(i1,3),dTmin{i1,3}] = <a href="../../AURORA/utilities/dt_avgstd.html" class="code" title="function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)">dt_avgstd</a>(tmin4278(2:end-1),tmin8446O2(2:end-1));
0249 <span class="keyword">end</span>
0250 
0251 <span class="comment">%% Extract peak intensities and Estimate the steady background intensities.</span>
0252 <span class="keyword">for</span> i1 = numel(It_Mm):-1:1
0253   <span class="keyword">if</span> numel(It_Mm{i1}{3,2}) &gt; 1
0254     I4278_max_at_max(i1,1:numel(It_Mm{i1}{2,2})) = It_Mm{i1}{4,2};
0255     I4278_min_at_max(i1,1:numel(It_Mm{i1}{2,2})) = interp1(It_Mm{i1}{3,2},It_Mm{i1}{5,2},It_Mm{i1}{2,2},<span class="string">'linear'</span>);
0256   <span class="keyword">else</span>
0257     I4278_max_at_max(i1,1:numel(It_Mm{i1}{2,2})) = It_Mm{i1}{2,2};
0258     I4278_min_at_max(i1,1:numel(It_Mm{i1}{2,2})) = nan;
0259   <span class="keyword">end</span>
0260   <span class="keyword">if</span> numel(It_Mm{i1}{3,3}) &gt; 1
0261     I6730_max_at_max(i1,1:numel(It_Mm{i1}{2,3})) = It_Mm{i1}{4,3};
0262     I6730_min_at_max(i1,1:numel(It_Mm{i1}{2,3})) = interp1(It_Mm{i1}{3,3},It_Mm{i1}{5,3},It_Mm{i1}{2,3},<span class="string">'linear'</span>);
0263   <span class="keyword">else</span>
0264     I6730_max_at_max(i1,1:numel(It_Mm{i1}{2,3})) = It_Mm{i1}{4,3};
0265     I6730_min_at_max(i1,1:numel(It_Mm{i1}{2,3})) = nan;
0266   <span class="keyword">end</span>
0267   <span class="keyword">if</span> numel(It_Mm{i1}{3,4}) &gt; 1
0268     I7774_max_at_max(i1,1:numel(It_Mm{i1}{2,4})) = It_Mm{i1}{4,4};
0269     I7774_min_at_max(i1,1:numel(It_Mm{i1}{2,4})) = interp1(It_Mm{i1}{3,4},It_Mm{i1}{5,4},It_Mm{i1}{2,4},<span class="string">'linear'</span>);
0270   <span class="keyword">else</span>
0271     I7774_max_at_max(i1,1:numel(It_Mm{i1}{2,4})) = It_Mm{i1}{4,4};
0272     I7774_min_at_max(i1,1:numel(It_Mm{i1}{2,4})) = nan;
0273   <span class="keyword">end</span>
0274   <span class="keyword">if</span> numel(It_Mm{i1}{3,5}) &gt; 1
0275     I8446_max_at_max(i1,1:numel(It_Mm{i1}{2,5})) = It_Mm{i1}{4,5};
0276     I8446_min_at_max(i1,1:numel(It_Mm{i1}{2,5})) = interp1(It_Mm{i1}{3,5},It_Mm{i1}{5,5},It_Mm{i1}{2,5},<span class="string">'linear'</span>);
0277   <span class="keyword">else</span>
0278     I8446_max_at_max(i1,1:numel(It_Mm{i1}{2,5})) = It_Mm{i1}{4,5};
0279     I8446_min_at_max(i1,1:numel(It_Mm{i1}{2,5})) = nan;
0280   <span class="keyword">end</span>
0281   <span class="keyword">if</span> numel(It_Mm{i1}{3,6}) &gt; 1
0282     I5577_max_at_max(i1,1:numel(It_Mm{i1}{2,6})) = It_Mm{i1}{4,6};
0283     I5577_min_at_max(i1,1:numel(It_Mm{i1}{2,6})) = interp1(It_Mm{i1}{3,6},It_Mm{i1}{5,6},It_Mm{i1}{2,6},<span class="string">'linear'</span>);
0284   <span class="keyword">else</span>
0285     I5577_max_at_max(i1,1:numel(It_Mm{i1}{2,6})) = It_Mm{i1}{4,6};
0286     I5577_min_at_max(i1,1:numel(It_Mm{i1}{2,6})) = nan;
0287   <span class="keyword">end</span>
0288   <span class="keyword">if</span> numel(It_Mm{i1}{3,7}) &gt; 1
0289     I6300_max_at_max(i1,1:numel(It_Mm{i1}{2,7})) = It_Mm{i1}{4,7};
0290     I6300_min_at_max(i1,1:numel(It_Mm{i1}{2,7})) = interp1(It_Mm{i1}{3,7},It_Mm{i1}{5,7},It_Mm{i1}{2,7},<span class="string">'linear'</span>);
0291   <span class="keyword">else</span>
0292     I6300_max_at_max(i1,1:numel(It_Mm{i1}{2,7})) = It_Mm{i1}{4,7};
0293     I6300_min_at_max(i1,1:numel(It_Mm{i1}{2,7})) = nan;
0294   <span class="keyword">end</span>
0295   <span class="keyword">if</span> numel(It_Mm{i1}{3,8}) &gt; 1
0296     I7774O_max_at_max(i1,1:numel(It_Mm{i1}{2,8})) = It_Mm{i1}{4,8};
0297     I7774O_min_at_max(i1,1:numel(It_Mm{i1}{2,8})) = interp1(It_Mm{i1}{3,8},It_Mm{i1}{5,8},It_Mm{i1}{2,8},<span class="string">'linear'</span>);
0298   <span class="keyword">else</span>
0299     I7774O_max_at_max(i1,1:numel(It_Mm{i1}{2,8})) = It_Mm{i1}{4,8};
0300     I7774O_min_at_max(i1,1:numel(It_Mm{i1}{2,8})) = nan;
0301   <span class="keyword">end</span>
0302   <span class="keyword">if</span> numel(It_Mm{i1}{3,9}) &gt; 1
0303     I7774O2_max_at_max(i1,1:numel(It_Mm{i1}{2,9})) = It_Mm{i1}{4,9};
0304     I7774O2_min_at_max(i1,1:numel(It_Mm{i1}{2,9})) = interp1(It_Mm{i1}{3,9},It_Mm{i1}{5,9},It_Mm{i1}{2,9},<span class="string">'linear'</span>);
0305   <span class="keyword">else</span>
0306     I7774O2_max_at_max(i1,1:numel(It_Mm{i1}{2,9})) = It_Mm{i1}{4,9};
0307     I7774O2_min_at_max(i1,1:numel(It_Mm{i1}{2,9})) = nan;
0308   <span class="keyword">end</span>
0309   <span class="keyword">if</span> numel(It_Mm{i1}{3,10}) &gt; 1
0310     I8446O_max_at_max(i1,1:numel(It_Mm{i1}{2,10})) = It_Mm{i1}{4,10};
0311     I8446O_min_at_max(i1,1:numel(It_Mm{i1}{2,10})) = interp1(It_Mm{i1}{3,10},It_Mm{i1}{5,10},It_Mm{i1}{2,10},<span class="string">'linear'</span>);
0312   <span class="keyword">else</span>
0313     I8446O_max_at_max(i1,1:numel(It_Mm{i1}{2,10})) = It_Mm{i1}{4,10};
0314     I8446O_min_at_max(i1,1:numel(It_Mm{i1}{2,10})) = nan;
0315   <span class="keyword">end</span>
0316   <span class="keyword">if</span> numel(It_Mm{i1}{3,11}) &gt; 1
0317     I8446O2_max_at_max(i1,1:numel(It_Mm{i1}{2,11})) = It_Mm{i1}{4,11};
0318     I8446O2_min_at_max(i1,1:numel(It_Mm{i1}{2,11})) = interp1(It_Mm{i1}{3,11},It_Mm{i1}{5,11},It_Mm{i1}{2,11},<span class="string">'linear'</span>);
0319   <span class="keyword">else</span>
0320     I8446O2_max_at_max(i1,1:numel(It_Mm{i1}{2,11})) = It_Mm{i1}{4,11};
0321     I8446O2_min_at_max(i1,1:numel(It_Mm{i1}{2,11})) = nan;
0322   <span class="keyword">end</span>
0323 <span class="keyword">end</span>
0324 
0325 <span class="comment">%% Calculate the relative modulation amplitude</span>
0326 <span class="keyword">for</span> i1 = size(I4278_min_at_max):-1:1,
0327   <span class="comment">% try</span>
0328   <span class="keyword">if</span> numel(It_Mm{i1}{2,2})
0329     I_mamp(i1,1) = nanmedian(1-I4278_min_at_max(i1,2:end-1)./I4278_max_at_max(i1,2:end-1));
0330     I_mamp(i1,2) = nanmedian(1-I6730_min_at_max(i1,2:end-1)./I6730_max_at_max(i1,2:end-1));
0331     I_mamp(i1,3) = nanmedian(1-I7774_min_at_max(i1,2:end-1)./I7774_max_at_max(i1,2:end-1));
0332     I_mamp(i1,4) = nanmedian(1-I8446_min_at_max(i1,2:end-1)./I8446_max_at_max(i1,2:end-1));
0333     I_mamp(i1,5) = nanmedian(1-I5577_min_at_max(i1,2:end-1)./I5577_max_at_max(i1,2:end-1));
0334     I_mamp(i1,6) = nanmedian(1-I6300_min_at_max(i1,2:end-1)./I6300_max_at_max(i1,2:end-1));
0335     
0336     I_mamp(i1,7) = nanmedian(1-I7774O_min_at_max(i1,2:end-1)./I7774O_max_at_max(i1,2:end-1));
0337     I_mamp(i1,8) = nanmedian(1-I7774O2_min_at_max(i1,2:end-1)./I7774O2_max_at_max(i1,2:end-1));
0338     
0339     I_mamp(i1,9) = nanmedian(1-I8446O_min_at_max(i1,2:end-1)./I8446O_max_at_max(i1,2:end-1));
0340     I_mamp(i1,10) = nanmedian(1-I8446O2_min_at_max(i1,2:end-1)./I8446O2_max_at_max(i1,2:end-1));
0341     
0342     stdI_mamp(i1,1) = nanstd(1-I4278_min_at_max(i1,2:end-1)./I4278_max_at_max(i1,2:end-1));
0343     stdI_mamp(i1,2) = nanstd(1-I6730_min_at_max(i1,2:end-1)./I6730_max_at_max(i1,2:end-1));
0344     stdI_mamp(i1,4) = nanstd(1-I8446_min_at_max(i1,2:end-1)./I8446_max_at_max(i1,2:end-1));
0345     stdI_mamp(i1,3) = nanstd(1-I7774_min_at_max(i1,2:end-1)./I7774_max_at_max(i1,2:end-1));
0346     stdI_mamp(i1,5) = nanstd(1-I5577_min_at_max(i1,2:end-1)./I5577_max_at_max(i1,2:end-1));
0347     stdI_mamp(i1,6) = nanstd(1-I6300_min_at_max(i1,2:end-1)./I6300_max_at_max(i1,2:end-1));
0348   <span class="keyword">end</span>
0349 <span class="keyword">end</span>
0350 
0351 <a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a> = [4278 18.75   6
0352                 6730 7.3532  3
0353                 7774 10.74   2
0354                 8446 10.99   1
0355                 5577 4.19    5
0356                 6300 1.967   4];
0357 
0358 <span class="comment">%% Load the input-parameters-log-file</span>
0359 <span class="comment">%  This merging of the parameters for the runs, kept in CP, and the</span>
0360 <span class="comment">%  parameters in the &quot;pars_of_ItMm_dirnames.txt&quot; directory is a</span>
0361 <span class="comment">%  &quot;straddling legacy hack&quot;. The reading of the file here should be</span>
0362 <span class="comment">%  phased out, and successively more run-parameters should be saved</span>
0363 <span class="comment">%  away in curr_par</span>
0364 FID = fopen(<span class="string">'pars_of_ItMm_dirnames.txt'</span>,<span class="string">'r'</span>);
0365 <span class="comment">%C = textread(FID,'%f%f%f%f%f%f%f%f%f%f%f%s');</span>
0366 C = textscan(FID, <span class="string">'%f%f%f%f%f%f%f%f%f%f%f%s'</span>,<span class="string">'commentstyle'</span>,<span class="string">'%'</span>);
0367 fclose(FID);       <span class="comment">%1 2 3 4 5 6 7 8 9 0 1</span>
0368 
0369 pitch_angle_widths = [10 30 60]; <span class="comment">% Q-D hard-coded version for</span>
0370                                  <span class="comment">% handling pitch-angle widths</span>
0371 pars_of_ItMm = cell2mat(C(:,1:end-1));
0372 
0373 p_o_ItMm(:,1)  = (1:size(CP,1))';        <span class="comment">% Running directory index</span>
0374 p_o_ItMm(:,2)  = cell2mat(CP(:,2));      <span class="comment">% Frequency of modulation</span>
0375 p_o_ItMm(:,3)  = cell2mat(CP(:,1))/1e3;  <span class="comment">% Source altitude</span>
0376 p_o_ItMm(:,5)  = cell2mat(CP(:,5))/1e3;  <span class="comment">% Peak energy of FAB</span>
0377 p_o_ItMm(:,7)  = 1;                      <span class="comment">% Flux-type flag (FAB - 1)</span>
0378 p_o_ItMm(:,8)  = ( cellfun(@(x) isequal(x,<span class="string">'H'</span>),CP(:,6)') - <span class="keyword">...</span><span class="comment"> % Modulation</span>
0379                    cellfun(@(x) isequal(x,<span class="string">'S'</span>),CP(:,6)') );    <span class="comment">% type, H:1 S:-1, P:0</span>
0380 p_o_ItMm(:,9)  = pitch_angle_widths(cellfun(@numel, CP(:,4))); <span class="comment">% Pitch-angle: 10, 30, 60</span>
0381 p_o_ItMm(:,10) = 1;                      <span class="comment">% Pitch-angle-distribution flag/Dummy</span>
0382 p_o_ItMm(:,11) = 1;                      <span class="comment">% Modulation type type: amplitude: 1, energy:-1</span>
0383 
0384 pars_of_ItMm(:,[1:3,5:end]) = p_o_ItMm(:,[1:3,5:end]);
0385 
0386 <span class="comment">%% Sub-sets identification suitable for plotting</span>
0387 <span class="comment">% Here we identify the column indices for the different parameters</span>
0388 <span class="comment">% of the pars_of_ItMm array</span>
0389 idx_f = 2;    <span class="comment">% modulation frequency</span>
0390 idx_z0 = 3;   <span class="comment">% source altitude</span>
0391 idx_Asc = 4;  <span class="comment">% scaling of thermospheric densities</span>
0392 idx_Ef = 5;   <span class="comment">% peak energy of FAB</span>
0393 <span class="comment">% idxLET = 6; % low-energy-tail (for Gaussian-type spectra)</span>
0394 idxSteb = 7;  <span class="comment">% supra-thermal electron burst (FAB)</span>
0395 idxH = 8;     <span class="comment">% Modulation-type (Harmonic/Pulse/Square)</span>
0396 idxtheta = 9; <span class="comment">% Pitch-angle-width</span>
0397 thetaFA = 10; <span class="comment">% Pitch-angle-distribution-type TBD/Dummy</span>
0398 <span class="comment">% idxAmEm = 11; % Flux/Energy-modulation</span>
0399 
0400 
0401 <span class="comment">%  1 indices to runs with E_f 7 keV, z0: 3000 km, FA</span>
0402 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0403 i_Ef7_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0404                    pars_of_ItMm(:,idx_Ef) == 7 &amp; <span class="keyword">...</span>
0405                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0406                    pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0407                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0408                    pars_of_ItMm(:,idxtheta) == thetaFA);
0409 <span class="comment">%  2 indices to runs with E_f 5 keV, z0: 3000 km, FA</span>
0410 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0411 i_Ef5_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0412                    pars_of_ItMm(:,idx_Ef) == 5 &amp; <span class="keyword">...</span>
0413                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0414                    pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0415                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0416                    pars_of_ItMm(:,idxtheta) == thetaFA);
0417 <span class="comment">%  3 indices to runs with E_f 3 keV, z0: 3000 km, FA</span>
0418 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0419 i_Ef3_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0420                    pars_of_ItMm(:,idx_Ef) == 3 &amp; <span class="keyword">...</span>
0421                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0422                    pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0423                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0424                    pars_of_ItMm(:,idxtheta) == thetaFA);
0425 
0426 
0427 <span class="comment">%  4 indices to runs with E_f 7 keV, z0: 4000 km, FA</span>
0428 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0429 i_Ef7_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0430                    pars_of_ItMm(:,idx_Ef) == 7 &amp; <span class="keyword">...</span>
0431                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0432                    pars_of_ItMm(:,idx_z0) == 4000 &amp; <span class="keyword">...</span>
0433                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0434                    pars_of_ItMm(:,idxtheta) == thetaFA);
0435 <span class="comment">%  5 indices to runs with E_f 5 keV, z0: 4000 km, FA</span>
0436 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0437 i_Ef5_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0438                    pars_of_ItMm(:,idx_Ef) == 5 &amp; <span class="keyword">...</span>
0439                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0440                    pars_of_ItMm(:,idx_z0) == 4000 &amp; <span class="keyword">...</span>
0441                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0442                    pars_of_ItMm(:,idxtheta) == thetaFA);
0443 <span class="comment">%  6 indices to runs with E_f 3 keV, z0: 4000 km, FA</span>
0444 <span class="comment">%  harmonic modulation all frequencies: [5, 7 10] Hz</span>
0445 i_Ef3_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0446                    pars_of_ItMm(:,idx_Ef) == 3 &amp; <span class="keyword">...</span>
0447                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0448                    pars_of_ItMm(:,idx_z0) == 4000 &amp; <span class="keyword">...</span>
0449                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0450                    pars_of_ItMm(:,idxtheta) == thetaFA);
0451 
0452 
0453 <span class="comment">% 7o variation with source height: z0 3000 km, P-n-L</span>
0454 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 5</span>
0455 i_f5_z2000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0456                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0457                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0458                   pars_of_ItMm(:,idx_f)==5 &amp; <span class="keyword">...</span>
0459                   pars_of_ItMm(:,idx_z0)==2000 &amp; <span class="keyword">...</span>
0460                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0461                   pars_of_ItMm(:,idxtheta) == thetaFA);
0462 <span class="comment">% 7p variation with source height: z0 2000 km, P-n-L</span>
0463 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 7</span>
0464 i_f7_z2000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0465                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0466                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0467                   pars_of_ItMm(:,idx_f)==7 &amp; <span class="keyword">...</span>
0468                   pars_of_ItMm(:,idx_z0)==2000 &amp; <span class="keyword">...</span>
0469                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0470                   pars_of_ItMm(:,idxtheta) == thetaFA);
0471 <span class="comment">% 7q variation with source height: z0 2000 km, P-n-L</span>
0472 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 10</span>
0473 i_f10_z2000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0474                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0475                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0476                    pars_of_ItMm(:,idx_f)==10 &amp; <span class="keyword">...</span>
0477                    pars_of_ItMm(:,idx_z0)==2000 &amp; <span class="keyword">...</span>
0478                    pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0479                    pars_of_ItMm(:,idxtheta) == thetaFA);
0480 
0481 <span class="comment">% 7a variation with source height: z0 3000 km, P-n-L</span>
0482 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 5</span>
0483 i_f5_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0484                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0485                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0486                   pars_of_ItMm(:,idx_f)==5 &amp; <span class="keyword">...</span>
0487                   pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0488                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0489                   pars_of_ItMm(:,idxtheta) == thetaFA);
0490 <span class="comment">% 7b variation with source height: z0 3000 km, P-n-L</span>
0491 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 7</span>
0492 i_f7_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0493                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0494                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0495                   pars_of_ItMm(:,idx_f)==7 &amp; <span class="keyword">...</span>
0496                   pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0497                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0498                   pars_of_ItMm(:,idxtheta) == thetaFA);
0499 <span class="comment">% 7c variation with source height: z0 3000 km, P-n-L</span>
0500 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 10</span>
0501 i_f10_z3000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0502                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0503                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0504                    pars_of_ItMm(:,idx_f)==10 &amp; <span class="keyword">...</span>
0505                    pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0506                    pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0507                    pars_of_ItMm(:,idxtheta) == thetaFA);
0508 
0509 <span class="comment">% 8a variation with source height: z0 4000 km, P-n-L</span>
0510 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 10</span>
0511 i_f5_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0512                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0513                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0514                   pars_of_ItMm(:,idx_f)==5 &amp; <span class="keyword">...</span>
0515                   pars_of_ItMm(:,idx_z0)==4000 &amp; <span class="keyword">...</span>
0516                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0517                   pars_of_ItMm(:,idxtheta) == thetaFA);
0518 <span class="comment">% 8b variation with source height: z0 4000 km, P-n-L</span>
0519 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 5</span>
0520 i_f7_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0521                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0522                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0523                   pars_of_ItMm(:,idx_f)==7 &amp; <span class="keyword">...</span>
0524                   pars_of_ItMm(:,idx_z0)==4000 &amp; <span class="keyword">...</span>
0525                   pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0526                   pars_of_ItMm(:,idxtheta) == thetaFA);
0527 <span class="comment">% 8c variation with source height: z0 4000 km, P-n-L</span>
0528 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 5</span>
0529 i_f10_z4000 = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0530                    pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0531                    pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0532                    pars_of_ItMm(:,idx_f)==10 &amp; <span class="keyword">...</span>
0533                    pars_of_ItMm(:,idx_z0)==4000 &amp; <span class="keyword">...</span>
0534                    pars_of_ItMm(:,end)==1 &amp; <span class="keyword">...</span>
0535                    pars_of_ItMm(:,idxtheta) == thetaFA);
0536 
0537 <span class="comment">% 9a variation with source height: z0 3000 km, P-n-L</span>
0538 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 5</span>
0539 i_f5_z3000_theta = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0540                         pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0541                         pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0542                         pars_of_ItMm(:,idx_f)==5 &amp; <span class="keyword">...</span>
0543                         pars_of_ItMm(:,idx_Ef)==3 &amp; <span class="keyword">...</span>
0544                         pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0545                         pars_of_ItMm(:,end)==1);
0546 <span class="comment">% 9b variation with source height: z0 3000 km, P-n-L</span>
0547 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 7</span>
0548 i_f7_z3000_theta = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0549                         pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0550                         pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0551                         pars_of_ItMm(:,idx_f)==7 &amp; <span class="keyword">...</span>
0552                         pars_of_ItMm(:,idx_Ef)==3 &amp; <span class="keyword">...</span>
0553                         pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0554                         pars_of_ItMm(:,end)==1);
0555 <span class="comment">% 9c variation with source height: z0 3000 km, P-n-L</span>
0556 <span class="comment">%  steb, Sine-wave, theta-max 3, f = 10 - not correct! TODO:fix</span>
0557 i_f10_z3000_theta = find(pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0558                          pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0559                          pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0560                          pars_of_ItMm(:,idx_f)==10 &amp; <span class="keyword">...</span>
0561                          pars_of_ItMm(:,idx_Ef)==3 &amp; <span class="keyword">...</span>
0562                          pars_of_ItMm(:,idx_z0)==3000 &amp; <span class="keyword">...</span>
0563                          pars_of_ItMm(:,end)==1);
0564 
0565 i_f5_E3_z = find(pars_of_ItMm(:,idxtheta) == thetaFA &amp; <span class="keyword">...</span>
0566                   pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0567                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0568                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0569                   pars_of_ItMm(:,idx_f)==5 &amp; <span class="keyword">...</span>
0570                   pars_of_ItMm(:,idx_Ef)==3 &amp; <span class="keyword">...</span>
0571                   pars_of_ItMm(:,end)==1);
0572 
0573 i_f10_E3_z = find(pars_of_ItMm(:,idxtheta) == thetaFA &amp; <span class="keyword">...</span>
0574                   pars_of_ItMm(:,idx_Asc) == 0 &amp; <span class="keyword">...</span>
0575                   pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0576                   pars_of_ItMm(:,idxSteb) == 1 &amp; <span class="keyword">...</span>
0577                   pars_of_ItMm(:,idx_f)==10 &amp; <span class="keyword">...</span>
0578                   pars_of_ItMm(:,idx_Ef)==3 &amp; <span class="keyword">...</span>
0579                   pars_of_ItMm(:,end)==1);
0580 
0581 iOmega_3_f5    = find(pars_of_ItMm(:,idxtheta) == thetaFA &amp; <span class="keyword">...</span>
0582                       pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0583                       pars_of_ItMm(:,idx_Ef) == 3 &amp; <span class="keyword">...</span>
0584                       pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0585                       pars_of_ItMm(:,idx_f) == 5);
0586 
0587 iOmega_3_f7   = find(pars_of_ItMm(:,idxtheta) == thetaFA &amp; <span class="keyword">...</span>
0588                      pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0589                      pars_of_ItMm(:,idx_Ef) == 3 &amp; <span class="keyword">...</span>
0590                      pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0591                      pars_of_ItMm(:,idx_f) == 7);
0592 
0593 iOmega_3_f10   = find(pars_of_ItMm(:,idxtheta) == thetaFA &amp; <span class="keyword">...</span>
0594                       pars_of_ItMm(:,idx_z0) == 3000 &amp; <span class="keyword">...</span>
0595                       pars_of_ItMm(:,idx_Ef) == 3 &amp; <span class="keyword">...</span>
0596                       pars_of_ItMm(:,idxH) == 1 &amp; <span class="keyword">...</span>
0597                       pars_of_ItMm(:,idx_f) == 10);
0598 
0599 
0600 <span class="comment">%% Figure 1: subplots for IMA and dt as function Ef plotted with</span>
0601 <span class="comment">%  subplots for f_f for source altitude at 3000 ('.-')</span>
0602 
0603 figure(<span class="string">'position'</span>,[845, 292, 926, 553])
0604 sph231 = subplot(2,3,1);
0605 set(gca,<span class="string">'fontsize'</span>,ftsza)
0606 ph_f = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
0607                         I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
0608                         i_Ef3_z3000,<span class="keyword">...</span><span class="comment">   % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
0609                         idx_f,<span class="keyword">...</span><span class="comment">         % index to parameters for X-variable</span>
0610                         1:4,<span class="keyword">...</span><span class="comment">           % index for parameters in Y-variable</span>
0611                         stdI_mamp,<span class="keyword">...</span><span class="comment">     %,...</span>
0612                         ax_ff_IMA,<span class="keyword">...</span><span class="comment"> % axis limits</span>
0613                         <span class="string">'E_{max}: 3 keV'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
0614                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % x-label-string</span>
0615                         <span class="string">'IM (%)'</span>,<span class="keyword">...</span><span class="comment">     % y-label-string</span>
0616                         ftszLT,<span class="keyword">...</span><span class="comment">            % font-size</span>
0617                         disp_n_wait,<span class="keyword">...</span>
0618                         [],<span class="keyword">...</span>
0619                         clrs_BRrK);     <span class="comment">% display-pars-n-pause</span>
0620 hold on
0621 
0622 set(gca,<span class="keyword">...</span>
0623     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0624     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0625     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0626     <span class="string">'ticklength'</span>,[0.02 0.04])
0627 
0628 sph234 = subplot(2,3,4);
0629 set(gca,<span class="string">'fontsize'</span>,ftsza)
0630 ph_f3 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0631                          dtmax*1e3,<span class="keyword">...</span>
0632                          i_Ef3_z3000,<span class="keyword">...</span>
0633                          idx_f,<span class="keyword">...</span>
0634                          1:3,<span class="keyword">...</span>
0635                          stdtmax,<span class="keyword">...</span>
0636                          ax_ff_dt,<span class="keyword">...</span>
0637                          <span class="string">''</span>,<span class="keyword">...</span>
0638                          <span class="string">''</span>,<span class="keyword">...</span>
0639                          <span class="string">'dt (ms)'</span>,<span class="keyword">...</span>
0640                          ftszLT,<span class="keyword">...</span>
0641                          disp_n_wait,<span class="keyword">...</span>
0642                          [],<span class="keyword">...</span>
0643                          clrs_BRrK(2:end));
0644 set(gca,<span class="keyword">...</span>
0645     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0646     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0647     <span class="string">'ticklength'</span>,[0.02 0.04])
0648 hold on
0649 
0650 ph_f3b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0651                           dtmin*1e3,<span class="keyword">...</span>
0652                           i_Ef3_z3000,<span class="keyword">...</span>
0653                           idx_f,<span class="keyword">...</span>
0654                           1:3,<span class="keyword">...</span>
0655                           [],<span class="keyword">...</span>
0656                           ax_ff_dt,<span class="keyword">...</span>
0657                           <span class="string">''</span>,<span class="keyword">...</span>
0658                           <span class="string">''</span>,<span class="keyword">...</span>
0659                           <span class="string">''</span>,<span class="keyword">...</span>
0660                           ftszLT,<span class="keyword">...</span>
0661                           disp_n_wait,<span class="keyword">...</span>
0662                           [],<span class="keyword">...</span>
0663                           clrs_BRrK(2:end));
0664 
0665 
0666 sph232 = subplot(2,3,2);
0667 set(gca,<span class="string">'fontsize'</span>,ftsza)
0668 ph_f = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0669                         I_mamp,<span class="keyword">...</span>
0670                         i_Ef5_z3000,<span class="keyword">...</span>
0671                         idx_f,<span class="keyword">...</span>
0672                         1:4,<span class="keyword">...</span>
0673                         stdI_mamp,<span class="keyword">...</span>
0674                         ax_ff_IMA,<span class="keyword">...</span>
0675                         <span class="string">'E_{max}: 5 keV'</span>,<span class="keyword">...</span>
0676                         <span class="string">''</span>,<span class="keyword">...</span>
0677                         <span class="string">''</span>,<span class="keyword">...</span>
0678                         ftszLT,<span class="keyword">...</span>
0679                         disp_n_wait,<span class="keyword">...</span>
0680                         [],<span class="keyword">...</span>
0681                         clrs_BRrK);
0682 set(gca,<span class="keyword">...</span>
0683     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0684     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0685     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0686     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0687     <span class="string">'ticklength'</span>,[0.02 0.04])
0688 hold on
0689 
0690 
0691 
0692 sph235 = subplot(2,3,5);
0693 set(gca,<span class="string">'fontsize'</span>,ftsza)
0694 ph_f3 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0695                         dtmax*1e3,<span class="keyword">...</span>
0696                         i_Ef5_z3000,<span class="keyword">...</span>
0697                         idx_f,<span class="keyword">...</span>
0698                         1:3,<span class="keyword">...</span>
0699                         stdtmax,<span class="keyword">...</span>
0700                         ax_ff_dt,<span class="keyword">...</span>
0701                         <span class="string">''</span>,<span class="keyword">...</span>
0702                         <span class="string">'frequency (Hz)'</span>,<span class="keyword">...</span>
0703                         <span class="string">''</span>,<span class="keyword">...</span>
0704                         ftszLT,<span class="keyword">...</span>
0705                         disp_n_wait,<span class="keyword">...</span>
0706                         [],<span class="keyword">...</span>
0707                         clrs_BRrK(2:end));
0708 hold on
0709 
0710 set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)
0711 ph_f3b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0712                           dtmin*1e3,<span class="keyword">...</span>
0713                           i_Ef5_z3000,<span class="keyword">...</span>
0714                           idx_f,<span class="keyword">...</span>
0715                           1:3,<span class="keyword">...</span>
0716                           [],<span class="keyword">...</span>
0717                           ax_ff_dt,<span class="keyword">...</span>
0718                           <span class="string">''</span>,<span class="keyword">...</span>
0719                           <span class="string">''</span>,<span class="keyword">...</span>
0720                           <span class="string">''</span>,<span class="keyword">...</span>
0721                           ftszLT,<span class="keyword">...</span>
0722                           disp_n_wait,<span class="keyword">...</span>
0723                           [],<span class="keyword">...</span>
0724                           clrs_BRrK(2:end));
0725 
0726 set(ph_f3b,<span class="string">'linewidth'</span>,1)
0727 set(gca,<span class="keyword">...</span>
0728     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0729     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0730     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0731     <span class="string">'ticklength'</span>,[0.02 0.04])
0732 
0733 sph233 = subplot(2,3,3);
0734 set(gca,<span class="keyword">...</span>
0735     <span class="string">'fontsize'</span>,ftsza)
0736 ph_f = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0737                         I_mamp,<span class="keyword">...</span>
0738                         i_Ef7_z3000,<span class="keyword">...</span>
0739                         idx_f,<span class="keyword">...</span>
0740                         1:4,<span class="keyword">...</span>
0741                         stdI_mamp,<span class="keyword">...</span>
0742                         ax_ff_IMA,<span class="keyword">...</span>
0743                         <span class="string">'E_{max}: 7 keV'</span>,<span class="keyword">...</span>
0744                         <span class="string">''</span>,<span class="keyword">...</span>
0745                         <span class="string">''</span>,<span class="keyword">...</span>
0746                         ftszLT,<span class="keyword">...</span>
0747                         disp_n_wait,<span class="keyword">...</span>
0748                         [],<span class="keyword">...</span>
0749                         clrs_BRrK);
0750 hold on
0751 set(gca,<span class="keyword">...</span>
0752     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0753     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0754     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0755     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0756     <span class="string">'ticklength'</span>,[0.02 0.04])
0757 
0758 
0759 sph236 = subplot(2,3,6);
0760 set(gca,<span class="keyword">...</span>
0761     <span class="string">'fontsize'</span>,ftsza)
0762 ph_f3 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0763                          dtmax*1e3,<span class="keyword">...</span>
0764                          i_Ef7_z3000,<span class="keyword">...</span>
0765                          idx_f,<span class="keyword">...</span>
0766                          1:3,<span class="keyword">...</span>
0767                          stdtmax,<span class="keyword">...</span>
0768                          ax_ff_dt,<span class="keyword">...</span>
0769                          <span class="string">''</span>,<span class="keyword">...</span>
0770                          <span class="string">''</span>,<span class="keyword">...</span>
0771                          <span class="string">''</span>,<span class="keyword">...</span>
0772                          ftszLT,<span class="keyword">...</span>
0773                          disp_n_wait,<span class="keyword">...</span>
0774                          [],<span class="keyword">...</span>
0775                          clrs_BRrK(2:end));
0776 hold on
0777 
0778 ph_f3b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0779                           dtmin*1e3,<span class="keyword">...</span>
0780                           i_Ef7_z3000,<span class="keyword">...</span>
0781                           idx_f,<span class="keyword">...</span>
0782                           1:3,<span class="keyword">...</span>
0783                           [],<span class="keyword">...</span>
0784                           ax_ff_dt,<span class="keyword">...</span>
0785                           <span class="string">''</span>,<span class="keyword">...</span>
0786                           <span class="string">''</span>,<span class="keyword">...</span>
0787                           <span class="string">''</span>,<span class="keyword">...</span>
0788                           ftszLT,<span class="keyword">...</span>
0789                           disp_n_wait,<span class="keyword">...</span>
0790                           [],<span class="keyword">...</span>
0791                           clrs_BRrK(2:end));
0792 set(ph_f3b,<span class="string">'linewidth'</span>,1)
0793 set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>)
0794 set(gca,<span class="keyword">...</span>
0795     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0796     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0797     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0798     <span class="string">'ticklength'</span>,[0.02 0.04])
0799 
0800 h_leg = legend(ph_f(:),<span class="keyword">...</span>
0801                <span class="string">'4278'</span>,<span class="keyword">...</span>
0802                <span class="string">'6730'</span>,<span class="keyword">...</span>
0803                <span class="string">'7774'</span>,<span class="keyword">...</span>
0804                <span class="string">'8446'</span>,<span class="keyword">...</span>
0805                <span class="string">'location'</span>,<span class="string">'northeast'</span>);
0806 
0807 set(h_leg,<span class="string">'position'</span>,get(h_leg,<span class="string">'position'</span>)+[0.02 0 0 0])
0808 axes(sph236)
0809 
0810 h_leg2 = legend([ph_f3(:);ph_f3(1);ph_f3b(1)],<span class="keyword">...</span>
0811                 <span class="string">'6730 - 4278'</span>,<span class="keyword">...</span>
0812                 <span class="string">'7774 - 4278'</span>,<span class="keyword">...</span>
0813                 <span class="string">'8446 - 4278'</span>,<span class="keyword">...</span>
0814                 <span class="string">'dt @peak'</span>,<span class="keyword">...</span>
0815                 <span class="string">'dt @min'</span>,<span class="keyword">...</span>
0816                 <span class="string">'location'</span>,<span class="string">'northeast'</span>);
0817 set(h_leg2,<span class="string">'position'</span>,get(h_leg2,<span class="string">'position'</span>)+[0.02 0.1 0 0])
0818 
0819 set(sph234,<span class="string">'position'</span>,get(sph234,<span class="string">'position'</span>)+[ 0    0.1 0 0])
0820 set(sph236,<span class="string">'position'</span>,get(sph236,<span class="string">'position'</span>)+[-0.1  0.1 0 0])
0821 set(sph235,<span class="string">'position'</span>,get(sph235,<span class="string">'position'</span>)+[-0.05 0.1 0 0])
0822 set(sph233,<span class="string">'position'</span>,get(sph233,<span class="string">'position'</span>)+[-0.1  0   0 0])
0823 set(sph232,<span class="string">'position'</span>,get(sph232,<span class="string">'position'</span>)+[-0.05 0   0 0])
0824 
0825 
0826 <span class="comment">%% Figure 2: subplots for IMA and dt as function f_f plotted with</span>
0827 <span class="comment">%  subplots for Ef for source altitude at 3000 ('.-')</span>
0828 figure(<span class="string">'position'</span>,[845, 292, 926, 553])
0829 sph231 = subplot(2,3,1);
0830 set(gca,<span class="string">'fontsize'</span>,ftsza)
0831 ph_E = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
0832                         I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
0833                         i_f5_z3000,<span class="keyword">...</span><span class="comment">    % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
0834                         idx_Ef,<span class="keyword">...</span><span class="comment">        % index to parameters for X-variable</span>
0835                         1:4,<span class="keyword">...</span><span class="comment">           % index for parameters in Y-variable</span>
0836                         stdI_mamp,<span class="keyword">...</span>
0837                         ax_Ef_IMA,<span class="keyword">...</span><span class="comment"> % axis limits</span>
0838                         <span class="string">'f_{f}: 5 Hz'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
0839                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % x-label-string</span>
0840                         <span class="string">'IM (%)'</span>,<span class="keyword">...</span><span class="comment">     % y-label-string</span>
0841                         ftszLT,<span class="keyword">...</span><span class="comment">            % font-size</span>
0842                         disp_n_wait,<span class="keyword">...</span>
0843                         [],<span class="keyword">...</span>
0844                         clrs_BRrK);     <span class="comment">% display-pars-n-pause</span>
0845 hold on
0846 
0847 set(gca,<span class="keyword">...</span>
0848     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0849     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0850     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0851     <span class="string">'ticklength'</span>,[0.02 0.04])
0852 
0853 sph234 = subplot(2,3,4);
0854 ph_E2 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0855                          dtmax*1e3,<span class="keyword">...</span>
0856                          i_f5_z3000,<span class="keyword">...</span>
0857                          idx_Ef,<span class="keyword">...</span>
0858                          1:3,<span class="keyword">...</span>
0859                          stdtmax,<span class="keyword">...</span>
0860                          ax_Ef_dt,<span class="keyword">...</span>
0861                          <span class="string">''</span>,<span class="keyword">...</span>
0862                          <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
0863                          <span class="string">'dt (ms)'</span>,<span class="keyword">...</span>
0864                          ftszLT,<span class="keyword">...</span>
0865                          disp_n_wait,<span class="keyword">...</span>
0866                          [],<span class="keyword">...</span>
0867                          clrs_BRrK(2:end));
0868 hold on
0869 
0870 ph_E2b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0871                           dtmin*1e3,<span class="keyword">...</span>
0872                           i_f5_z3000,<span class="keyword">...</span>
0873                           idx_Ef,<span class="keyword">...</span>
0874                           1:3,<span class="keyword">...</span>
0875                           [],<span class="keyword">...</span>
0876                           ax_Ef_dt,<span class="keyword">...</span>
0877                           <span class="string">''</span>,<span class="keyword">...</span>
0878                           <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
0879                           <span class="string">'dt (ms)'</span>,<span class="keyword">...</span>
0880                           ftszLT,<span class="keyword">...</span>
0881                           disp_n_wait,<span class="keyword">...</span>
0882                           [],<span class="keyword">...</span>
0883                           clrs_BRrK(2:end));
0884 hold on
0885 set(ph_E2b,<span class="string">'linewidth'</span>,1)
0886 
0887 set(gca,<span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0888         <span class="string">'fontsize'</span>,ftsza,<span class="keyword">...</span>
0889         <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0890         <span class="string">'ticklength'</span>,[0.02 0.04])
0891 
0892 sph232 = subplot(2,3,2);
0893 set(gca,<span class="string">'fontsize'</span>,ftsza)
0894 ph_E = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
0895                         I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
0896                         i_f7_z3000,<span class="keyword">...</span><span class="comment">    % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
0897                         idx_Ef,<span class="keyword">...</span><span class="comment">        % index to parameters for X-variable</span>
0898                         1:4,<span class="keyword">...</span><span class="comment">           % index for parameters in Y-variable</span>
0899                         stdI_mamp,<span class="keyword">...</span>
0900                         ax_Ef_IMA,<span class="keyword">...</span><span class="comment"> % axis limits</span>
0901                         <span class="string">'f_{f}: 7 Hz'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
0902                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % x-label-string</span>
0903                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % y-label-string</span>
0904                         ftszLT,<span class="keyword">...</span><span class="comment">            % font-size</span>
0905                         disp_n_wait,<span class="keyword">...</span>
0906                         [],<span class="keyword">...</span>
0907                         clrs_BRrK);     <span class="comment">% display-pars-n-pause</span>
0908 hold on
0909 set(gca,<span class="keyword">...</span>
0910     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0911     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0912     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0913     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0914     <span class="string">'ticklength'</span>,[0.02 0.04])
0915 
0916 sph235 = subplot(2,3,5);
0917 set(gca,<span class="keyword">...</span>
0918     <span class="string">'fontsize'</span>,ftsza)
0919 ph_E2 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0920                          dtmax*1e3,<span class="keyword">...</span>
0921                          i_f7_z3000,<span class="keyword">...</span>
0922                          idx_Ef,<span class="keyword">...</span>
0923                          1:3,<span class="keyword">...</span>
0924                          stdtmax,<span class="keyword">...</span>
0925                          ax_Ef_dt,<span class="keyword">...</span>
0926                          <span class="string">''</span>,<span class="keyword">...</span>
0927                          <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
0928                          <span class="string">''</span>,<span class="keyword">...</span>
0929                          ftszLT,<span class="keyword">...</span>
0930                          disp_n_wait,<span class="keyword">...</span>
0931                          [],<span class="keyword">...</span>
0932                          clrs_BRrK(2:end));
0933 hold on
0934 
0935 ph_E2b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0936                           dtmin*1e3,<span class="keyword">...</span>
0937                           i_f7_z3000,<span class="keyword">...</span>
0938                           idx_Ef,<span class="keyword">...</span>
0939                           1:3,<span class="keyword">...</span>
0940                           [],<span class="keyword">...</span>
0941                           ax_Ef_dt,<span class="keyword">...</span>
0942                           <span class="string">''</span>,<span class="keyword">...</span>
0943                           <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
0944                           <span class="string">''</span>,<span class="keyword">...</span>
0945                           ftszLT,<span class="keyword">...</span>
0946                           disp_n_wait,<span class="keyword">...</span>
0947                           [],<span class="keyword">...</span>
0948                           clrs_BRrK(2:end));
0949 hold on
0950 set(ph_E2b,<span class="string">'linewidth'</span>,1)
0951 set(gca,<span class="keyword">...</span>
0952     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0953     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0954     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0955     <span class="string">'ticklength'</span>,[0.02 0.04])
0956 
0957 sph233 = subplot(2,3,3);
0958 set(gca,<span class="keyword">...</span>
0959     <span class="string">'fontsize'</span>,ftsza)
0960 ph_E = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
0961                         I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
0962                         i_f10_z3000,<span class="keyword">...</span><span class="comment">    % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
0963                         idx_Ef,<span class="keyword">...</span><span class="comment">        % index to parameters for X-variable</span>
0964                         1:4,<span class="keyword">...</span><span class="comment">           % index for parameters in Y-variable</span>
0965                         stdI_mamp,<span class="keyword">...</span>
0966                         ax_Ef_IMA,<span class="keyword">...</span><span class="comment"> % axis limits</span>
0967                         <span class="string">'f_{f}: 10 Hz'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
0968                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % x-label-string</span>
0969                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">            % y-label-string</span>
0970                         ftszLT,<span class="keyword">...</span><span class="comment">            % font-size</span>
0971                         disp_n_wait,<span class="keyword">...</span>
0972                         [],<span class="keyword">...</span>
0973                         clrs_BRrK);     <span class="comment">% display-pars-n-pause</span>
0974 hold on
0975 set(gca,<span class="keyword">...</span>
0976     <span class="string">'xticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0977     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
0978     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
0979     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
0980     <span class="string">'ticklength'</span>,[0.02 0.04])
0981 
0982 sph236 = subplot(2,3,6);
0983 set(gca,<span class="keyword">...</span>
0984     <span class="string">'fontsize'</span>,ftsza)
0985 ph_E2 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
0986                          dtmax*1e3,<span class="keyword">...</span>
0987                          i_f10_z3000,<span class="keyword">...</span>
0988                          idx_Ef,<span class="keyword">...</span>
0989                          1:3,<span class="keyword">...</span>
0990                          stdtmax,<span class="keyword">...</span>
0991                          ax_Ef_dt,<span class="keyword">...</span>
0992                          <span class="string">''</span>,<span class="keyword">...</span>
0993                          <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
0994                          <span class="string">''</span>,<span class="keyword">...</span>
0995                          ftszLT,<span class="keyword">...</span>
0996                          disp_n_wait,<span class="keyword">...</span>
0997                          [],<span class="keyword">...</span>
0998                          clrs_BRrK(2:end));
0999 hold on
1000 
1001 ph_E2b = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span>
1002                           dtmin*1e3,<span class="keyword">...</span>
1003                           i_f10_z3000,<span class="keyword">...</span>
1004                           idx_Ef,<span class="keyword">...</span>
1005                           1:3,<span class="keyword">...</span>
1006                           [],<span class="keyword">...</span>
1007                           ax_Ef_dt,<span class="keyword">...</span>
1008                           <span class="string">''</span>,<span class="keyword">...</span>
1009                           <span class="string">'E_{max} (keV)'</span>,<span class="keyword">...</span>
1010                           <span class="string">''</span>,<span class="keyword">...</span>
1011                           ftszLT,<span class="keyword">...</span>
1012                           disp_n_wait,<span class="keyword">...</span>
1013                           [],<span class="keyword">...</span>
1014                           clrs_BRrK(2:end));
1015 hold on
1016 set(ph_E2b,<span class="string">'linewidth'</span>,1)
1017 set(gca,<span class="keyword">...</span>
1018     <span class="string">'yticklabel'</span>,<span class="string">''</span>,<span class="keyword">...</span>
1019     <span class="string">'box'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
1020     <span class="string">'tickdir'</span>,<span class="string">'out'</span>,<span class="keyword">...</span>
1021     <span class="string">'ticklength'</span>,[0.02 0.04])
1022 
1023 h_leg = legend(ph_E(:),<span class="keyword">...</span>
1024                <span class="string">'4278'</span>,<span class="keyword">...</span>
1025                <span class="string">'6730'</span>,<span class="keyword">...</span>
1026                <span class="string">'7774'</span>,<span class="keyword">...</span>
1027                <span class="string">'8446'</span>);
1028 set(h_leg,<span class="string">'position'</span>,get(h_leg,<span class="string">'position'</span>)+[0.03 0 0 0])
1029 
1030 
1031 <span class="comment">% sph236 = subplot(2,3,6);</span>
1032 axes(sph236)
1033 set(gca,<span class="string">'fontsize'</span>,ftsza)
1034 
1035 h_leg2 = legend([ph_E2(:);ph_E2(1);ph_E2b(1)],<span class="keyword">...</span><span class="comment">                  </span>
1036                 <span class="string">'6730 - 4278'</span>,<span class="keyword">...</span>
1037                 <span class="string">'7774 - 4278'</span>,<span class="keyword">...</span>
1038                 <span class="string">'8446 - 4278'</span>,<span class="keyword">...</span>
1039                 <span class="string">'dt @peak'</span>,<span class="keyword">...</span>
1040                 <span class="string">'dt @min'</span>,<span class="keyword">...</span>
1041                 <span class="string">'location'</span>,<span class="string">'northeast'</span>);
1042 <span class="comment">% This &quot;works&quot; with some manual labour: '$\hat{I}_{7774} \leftrightarrow \hat{I}_{4278}$',...</span>
1043 
1044 set(h_leg2,<span class="string">'position'</span>,get(h_leg2,<span class="string">'position'</span>)+[0.03 0.1 0 0])
1045 
1046 set(sph234,<span class="string">'position'</span>,get(sph234,<span class="string">'position'</span>)+[ 0    0.1 0 0])
1047 set(sph236,<span class="string">'position'</span>,get(sph236,<span class="string">'position'</span>)+[-0.1  0.1 0 0])
1048 set(sph235,<span class="string">'position'</span>,get(sph235,<span class="string">'position'</span>)+[-0.05 0.1 0 0])
1049 set(sph233,<span class="string">'position'</span>,get(sph233,<span class="string">'position'</span>)+[-0.1  0   0 0])
1050 set(sph232,<span class="string">'position'</span>,get(sph232,<span class="string">'position'</span>)+[-0.05 0   0 0])
1051 
1052 <span class="comment">%% Figure 3: subplots for IMA and as a function of pitch-angle</span>
1053 <span class="comment">%  width and source altitude</span>
1054 
1055 figure
1056 <span class="comment">%sph231 =</span>
1057 subplot(2,3,2);
1058 set(gca,<span class="string">'fontsize'</span>,ftsza)
1059 ph5 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
1060                        I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
1061                        i_f5_z3000_theta,<span class="keyword">...</span><span class="comment"> % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
1062                        idxtheta,<span class="keyword">...</span><span class="comment">         % index to parameters for X-variable</span>
1063                        1:4,<span class="keyword">...</span><span class="comment">           % index for parameters in Y-variable</span>
1064                        [],<span class="keyword">...</span>
1065                        ax_dtheta_IMA,<span class="keyword">...</span><span class="comment"> % axis limits</span>
1066                        <span class="string">'IM vs \theta_{max}'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
1067                        <span class="string">'\theta_{max}'</span>,<span class="keyword">...</span><span class="comment">            % x-label-string</span>
1068                        <span class="string">''</span>,<span class="keyword">...</span><span class="comment">     % y-label-string</span>
1069                        ftszLT,<span class="keyword">...</span><span class="comment">            % font-size</span>
1070                        disp_n_wait,<span class="keyword">...</span>
1071                        <span class="string">'.-'</span>,<span class="keyword">...</span>
1072                         clrs_BRrK);
1073 hold on
1074 set(ph5,<span class="string">'linewidth'</span>,1)
1075 hold on
1076 
1077 
1078 subplot(2,3,2);
1079 set(gca,<span class="string">'fontsize'</span>,ftsza)
1080 ph10 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array</span>
1081                         I_mamp,<span class="keyword">...</span><span class="comment">        % Y-values, relative modulation amplitude</span>
1082                         i_f10_z3000_theta,<span class="keyword">...</span><span class="comment"> % run-indices to plot, E-flickering 3kEv, z0 3000 km</span>
1083                         idxtheta,<span class="keyword">...</span><span class="comment">         % index to parameters for X-variable</span>
1084                         1:4,<span class="keyword">...</span><span class="comment">            % index for parameters in Y-variable</span>
1085                         [],<span class="keyword">...</span>
1086                         ax_dtheta_IMA,<span class="keyword">...</span><span class="comment">  % axis limits</span>
1087                         <span class="string">'IM vs  \theta_{max}'</span>,<span class="keyword">...</span><span class="comment"> % title-string</span>
1088                         <span class="string">'\theta_{max} (deg)'</span>,<span class="keyword">...</span><span class="comment">             % x-label-string</span>
1089                         <span class="string">''</span>,<span class="keyword">...</span><span class="comment">             % y-label-string</span>
1090                         ftszLT,<span class="keyword">...</span><span class="comment">             % font-size</span>
1091                         disp_n_wait,<span class="keyword">...</span>
1092                         <span class="string">'.--'</span>,<span class="keyword">...</span>
1093                         clrs_BRrK); <span class="comment">% display-pars-n-pause</span>
1094 set(ph10,<span class="string">'linewidth'</span>,1)
1095 
1096 set(gca,<span class="string">'xtick'</span>,[0 30 60])
1097 
1098 subplot(2,3,1);
1099 set(gca,<span class="string">'fontsize'</span>,ftsza)
1100 
1101 ph_z0_f5 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array                                 </span>
1102                             I_mamp,<span class="keyword">...</span>
1103                             i_f5_E3_z,<span class="keyword">...</span><span class="comment"> % run-indices to plot, E-flickering 3kEv, z0 3000 km        </span>
1104                             idx_z0,<span class="keyword">...</span>
1105                             1:4,<span class="keyword">...</span><span class="comment">              % index for parameters in Y-variable</span>
1106                             [],<span class="keyword">...</span>
1107                             ax_z0_IMA,<span class="keyword">...</span><span class="comment">  % axis limits</span>
1108                             <span class="string">'IM vs z_0'</span>,<span class="keyword">...</span><span class="comment">               % title-string</span>
1109                             <span class="string">'z_{0} (km)'</span>,<span class="keyword">...</span><span class="comment">   % x-label-string</span>
1110                             <span class="string">'IM (%)'</span>,<span class="keyword">...</span><span class="comment">     % y-label-string</span>
1111                             ftszLT,<span class="keyword">...</span><span class="comment">               % font-size</span>
1112                             disp_n_wait,<span class="keyword">...</span>
1113                             <span class="string">'.-'</span>,<span class="keyword">...</span>
1114                             clrs_BRrK);     <span class="comment">% display-pars-n-pause</span>
1115 set(ph_z0_f5,<span class="string">'linewidth'</span>,1)
1116 
1117 hold on
1118 ph_z0_f10 = <a href="../../AURORA/tools/plot_pars_n_pars.html" class="code" title="function ph = plot_pars_n_pars(pars_of_ItMm,Yvals,idx2plot,idx4x,idx4Yvals,stdY,axlims,tstr,xstr,ystr,ftsz,dispP,lstl,clrs)">plot_pars_n_pars</a>(pars_of_ItMm,<span class="keyword">...</span><span class="comment">  % Etrp-parameters array                                 </span>
1119                              I_mamp,<span class="keyword">...</span>
1120                              i_f10_E3_z,<span class="keyword">...</span><span class="comment"> % run-indices to plot, E-flickering 3kEv, z0 3000 km        </span>
1121                              idx_z0,<span class="keyword">...</span>
1122                              1:4,<span class="keyword">...</span><span class="comment">              % index for parameters in Y-variable</span>
1123                              [],<span class="keyword">...</span>
1124                              ax_z0_IMA,<span class="keyword">...</span><span class="comment">  % axis limits</span>
1125                              <span class="string">''</span>,<span class="keyword">...</span><span class="comment">               % title-string</span>
1126                              <span class="string">'z_0 (km)'</span>,<span class="keyword">...</span><span class="comment">   % x-label-string</span>
1127                              <span class="string">'IM (%)'</span>,<span class="keyword">...</span><span class="comment">     % y-label-string</span>
1128                              ftszLT,<span class="keyword">...</span><span class="comment">               % font-size</span>
1129                              disp_n_wait,<span class="keyword">...</span>
1130                              <span class="string">'.--'</span>,<span class="keyword">...</span>
1131                              clrs_BRrK);
1132 set(ph_z0_f10,<span class="string">'linewidth'</span>,1)
1133 
1134 
1135 h_leg12 = legend([ph_z0_f5(:);ph_z0_f5(1);ph_z0_f10(:)],<span class="keyword">...</span>
1136        <span class="string">'4278'</span>,<span class="keyword">...</span>
1137        <span class="string">'6730'</span>,<span class="keyword">...</span>
1138        <span class="string">'7774'</span>,<span class="keyword">...</span>
1139        <span class="string">'8446'</span>,<span class="keyword">...</span>
1140        <span class="string">'f_f: 5 Hz'</span>,<span class="keyword">...</span>
1141        <span class="string">'f_f: 10 Hz'</span>);
1142 
1143 set(h_leg12,<span class="string">'position'</span>,get(h_leg12,<span class="string">'position'</span>)+[0.03 0.1 0 0])
1144 
1145 set(gcf,<span class="string">'position'</span>,[405 460 835 514])
1146 set(h_leg12,<span class="string">'position'</span>,[0.644542343883663   0.635418403742820   0.127544910179641   0.268725680933852])
1147 
1148 <span class="comment">%% Figure 4: IMA vs Ethreshold</span>
1149 figure
1150 cmp = [ 0            0            0
1151         0.6          0            0
1152         0.9          0            0.1
1153         1            0.2          0
1154         0.3          1            0
1155         0            0            1];
1156 colormap(cmp)
1157 phO = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3:<span class="keyword">end</span>,2),<span class="keyword">...</span>
1158            I_mamp(i_Ef3_z3000,[3 4 5 6]),<span class="keyword">...</span>
1159            <span class="string">'-'</span>,<span class="string">'linewidth'</span>,2);
1160 hold on
1161 phN2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(1:2,2),<span class="keyword">...</span>
1162             I_mamp(i_Ef3_z3000,[1 2]),<span class="keyword">...</span>
1163             <span class="string">'--'</span>,<span class="string">'linewidth'</span>,2);
1164 <span class="keyword">for</span> i1 = 1:6,
1165   phP(i1) = plot(-1,0.1*i1,<span class="string">'.'</span>,<span class="string">'markersize'</span>,31,<span class="string">'color'</span>,cmp(i1,:));
1166 <span class="keyword">end</span>
1167 
1168 ph7774O = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3,2),I_mamp(i_Ef3_z3000,7),<span class="string">'s'</span>,<span class="string">'color'</span>,cmp(2,:),<span class="string">'linewidth'</span>,2);
1169 ph7774O2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3,2)+5.15,I_mamp(i_Ef3_z3000,8),<span class="string">'d'</span>,<span class="string">'color'</span>,cmp(2,:),<span class="string">'linewidth'</span>,2);
1170 ph8446O = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(4,2),I_mamp(i_Ef3_z3000,9),<span class="string">'ks'</span>,<span class="string">'linewidth'</span>,2);
1171 ph8446O2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(4,2)+5.15,I_mamp(i_Ef3_z3000,10),<span class="string">'kd'</span>,<span class="string">'linewidth'</span>,2);
1172 
1173 legend([phO;phO(1);phN2(1);phP([6 1 2 3 5 4])';ph7774O(1);ph7774O2(1);ph8446O(1);ph8446O2(1)],<span class="keyword">...</span>
1174        <span class="string">'5 Hz'</span>,<span class="string">'7 Hz'</span>,<span class="string">'10 Hz'</span>,<span class="keyword">...</span>
1175        <span class="string">'O'</span>,<span class="string">'N_2'</span>,<span class="keyword">...</span>
1176        <span class="string">'4278'</span>,<span class="string">'8446'</span>,<span class="string">'7774'</span>,<span class="string">'6730'</span>,<span class="keyword">...</span>
1177        <span class="string">'O1S'</span>,<span class="string">'O1D'</span>,<span class="string">'7774(O)'</span>,<span class="string">'7774(O_2)'</span>,<span class="string">'8446(O)'</span>,<span class="string">'8446(O_2)'</span>,<span class="keyword">...</span>
1178        <span class="string">'location'</span>,<span class="string">'northeastoutside'</span>)
1179 axis(ax_ExcT_IMA)
1180 sX = repmat(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(:,2)',size(i_Ef3_z3000));
1181 sY = I_mamp(i_Ef3_z3000,[1 2 3 4 5 6]);
1182 sV = repmat(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(:,3)',size(i_Ef3_z3000));
1183 scatter(sX(:),sY(:),73,sV(:),<span class="string">'filled'</span>)
1184 set(gca,<span class="keyword">...</span>
1185     <span class="string">'xtick'</span>,2:2:20,<span class="keyword">...</span>
1186     <span class="string">'fontsize'</span>,12)
1187 xlabel(<span class="string">'Excitation threshold (eV)'</span>,<span class="string">'fontsize'</span>,ftszLT)
1188 ylabel(<span class="string">'Modulation amplitude (%)'</span>,<span class="string">'fontsize'</span>,ftszLT) 
1189 
1190 
1191 <span class="comment">%% Figure 5: dtmax vs Ethreshold</span>
1192 <span class="comment">% dtmax(:,1) = tMax4278 - tMax6730;</span>
1193 <span class="comment">% dtmax(:,2) = tMax4278 - tMax7774;</span>
1194 <span class="comment">% dtmax(:,3) = tMax4278 - tMax8446;</span>
1195 <span class="comment">% dtmax(:,4) = tMax4278 - tMaxO1S;</span>
1196 <span class="comment">% dtmax(:,5) = tMax4278 - tMaxO1D;</span>
1197 <span class="comment">% dtmax(:,6) = tMax4278 - tMax7774O;</span>
1198 <span class="comment">% dtmax(:,7) = tMax4278 - tMax7774O2;</span>
1199 <span class="comment">% dtmax(:,8) = tMax4278 - tMax8446O;</span>
1200 <span class="comment">% dtmax(:,9) = tMax4278 - tMax8446O2;</span>
1201 
1202 figure
1203 cmp = [ 0            0            0
1204         0.6          0            0
1205         0.9          0            0.1
1206         1            0.2          0
1207         0.3          1            0
1208         0            0            1];
1209 colormap(cmp)
1210 
1211 phO = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3:<span class="keyword">end</span>,2),<span class="keyword">...</span>
1212            1e3*dtmax(i_Ef3_z3000,[3 4 5 6]-1),<span class="keyword">...</span>
1213            <span class="string">'-'</span>,<span class="string">'linewidth'</span>,2);
1214 hold on
1215 phN2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(2,2),<span class="keyword">...</span>
1216             1e3*dtmax(i_Ef3_z3000,[2]-1),<span class="keyword">...</span>
1217             <span class="string">'--'</span>,<span class="string">'linewidth'</span>,2);
1218 <span class="keyword">for</span> i1 = 1:6,
1219   phP(i1) = plot(-1,0.1*i1,<span class="string">'.'</span>,<span class="string">'markersize'</span>,31,<span class="string">'color'</span>,cmp(i1,:));
1220 <span class="keyword">end</span>
1221 
1222 ph7774O = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3,2),1e3*dtmax(i_Ef3_z3000,7-1),<span class="string">'s'</span>,<span class="string">'color'</span>,cmp(2,:),<span class="string">'linewidth'</span>,2);
1223 ph7774O2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(3,2)+5.15,1e3*dtmax(i_Ef3_z3000,8-1),<span class="string">'d'</span>,<span class="string">'color'</span>,cmp(2,:),<span class="string">'linewidth'</span>,2);
1224 ph8446O = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(4,2),1e3*dtmax(i_Ef3_z3000,9-1),<span class="string">'ks'</span>,<span class="string">'linewidth'</span>,2);
1225 ph8446O2 = plot(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(4,2)+5.15,1e3*dtmax(i_Ef3_z3000,10-1),<span class="string">'kd'</span>,<span class="string">'linewidth'</span>,2);
1226 
1227 legend([phO;phO(1);phN2(1);phP([6 1 2 3 5 4])';ph7774O(1);ph7774O2(1);ph8446O(1);ph8446O2(1)],<span class="keyword">...</span>
1228        <span class="string">'5 Hz'</span>,<span class="string">'7 Hz'</span>,<span class="string">'10 Hz'</span>,<span class="keyword">...</span>
1229        <span class="string">'O'</span>,<span class="string">'N_2'</span>,<span class="keyword">...</span>
1230        <span class="string">'4278'</span>,<span class="string">'8446'</span>,<span class="string">'7774'</span>,<span class="string">'6730'</span>,<span class="keyword">...</span>
1231        <span class="string">'O1S'</span>,<span class="string">'O1D'</span>,<span class="string">'7774(O)'</span>,<span class="string">'7774(O_2)'</span>,<span class="string">'8446(O)'</span>,<span class="string">'8446(O_2)'</span>,<span class="keyword">...</span>
1232        <span class="string">'location'</span>,<span class="string">'northeastoutside'</span>)
1233 axis(ax_ExcT_dt)
1234 
1235 sX = repmat(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(2:<span class="keyword">end</span>,2)',size(i_Ef3_z3000));
1236 sY = 1e3*dtmax(i_Ef3_z3000,[2 3 4 5 6]-1);
1237 sV = repmat(<a href="../../AURORA/utilities/E_levelsOnN2.html" class="code" title="function lambda_n_E = E_levelsOnN2()">E_levelsOnN2</a>(2:<span class="keyword">end</span>,3)',size(i_Ef3_z3000));
1238 scatter(sX(:),sY(:),73,sV(:),<span class="string">'filled'</span>)
1239 set(gca,<span class="keyword">...</span>
1240     <span class="string">'xtick'</span>,2:2:20,<span class="keyword">...</span>
1241     <span class="string">'fontsize'</span>,12)
1242 xlabel(<span class="string">'Excitation threshold (eV)'</span>,<span class="string">'fontsize'</span>,ftszLT)
1243 ylabel(<span class="string">'dt (ms)'</span>,<span class="string">'fontsize'</span>,ftszLT) 
1244 caxis([1 6])
1245 
1246 <a name="_sub1" href="#_subfunctions" class="code">function [t_M,I_M,t_m,I_m] = local_minMaxFinder(t,I)</a>
1247 <span class="comment">% LOCAL_MINMAXFINDER - identifies local MAXima and minima</span>
1248 <span class="comment">% discarding first extreme-values</span>
1249 <span class="comment">%</span>
1250 
1251 idxM = local_max(I);
1252 idxM(idxM == 1) = [];
1253 idxM(idxM == numel(I)) = [];
1254 I_M = I(idxM);
1255 t_M = t(idxM);
1256 idxm = local_max(-I);
1257 idxm(idxm == 1) = [];
1258 idxm(idxm == numel(I)) = [];
1259 I_m = I(idxm);
1260 t_m = t(idxm);
1261 
1262 
1263 <a name="_sub2" href="#_subfunctions" class="code">function plot_ItMm(t,I_lambda,tM,IM,tm,Im,spnr,titlestring,clr)</a>
1264 <span class="comment">% PLOT_ITMM - subfunction for plotting parameters in subplots with decorations</span>
1265 <span class="comment">%</span>
1266 subplot(3,2,spnr)
1267 
1268 plot(t,I_lambda,<span class="string">'color'</span>,clr)
1269 hold on
1270 plot(tm,Im,<span class="string">'kh'</span>)
1271 plot(tM,IM,<span class="string">'ch'</span>)
1272 title(titlestring)</pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>