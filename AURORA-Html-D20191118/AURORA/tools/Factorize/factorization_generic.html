<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of factorization_generic</title>
  <meta name="keywords" content="factorization_generic">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html AURORA --><!-- ../menu.html tools --><!-- menu.html Factorize -->
<h1>factorization_generic
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="factorization_generic.html" class="code" title="">factorization_generic</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="factorization_dense_chol.html" class="code" title="">factorization_dense_chol</a>	</li><li><a href="factorization_dense_lu.html" class="code" title="">factorization_dense_lu</a>	</li><li><a href="factorization_dense_qr.html" class="code" title="">factorization_dense_qr</a>	</li><li><a href="factorization_dense_qrt.html" class="code" title="">factorization_dense_qrt</a>	</li><li><a href="factorization_generic.html" class="code" title="">factorization_generic</a>	</li><li><a href="factorization_sparse_chol.html" class="code" title="">factorization_sparse_chol</a>	</li><li><a href="factorization_sparse_lu.html" class="code" title="">factorization_sparse_lu</a>	</li><li><a href="factorization_sparse_qr.html" class="code" title="">factorization_sparse_qr</a>	</li><li><a href="factorization_sparse_qrt.html" class="code" title="">factorization_sparse_qrt</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function x = mldivide (F,b,is_inverse)</a></li><li><a href="#_sub2" class="code">function x = mrdivide (b,F,is_inverse)</a></li><li><a href="#_sub3" class="code">function F = inverse (F)</a></li><li><a href="#_sub4" class="code">function S = double (F)</a></li><li><a href="#_sub5" class="code">function e = end (F,k,n)</a></li><li><a href="#_sub6" class="code">function [m n] = size (F,k)</a></li><li><a href="#_sub7" class="code">function x = mtimes (y,z)</a></li><li><a href="#_sub8" class="code">function C = subsref (F,ij)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="factorization_generic.html" class="code" title="">factorization_generic</a>
0002 <span class="comment">%FACTORIZATION_GENERIC a generic matrix factorization object</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% This is an abstract class that is specialized into 8 different kinds of</span>
0005 <span class="comment">% matrix factorizations:</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   factorization_dense_chol    dense Cholesky      A = R'*R</span>
0008 <span class="comment">%   factorization_dense_lu      dense LU            p*A = L*U</span>
0009 <span class="comment">%   factorization_dense_qr      dense QR of A       A = Q*R</span>
0010 <span class="comment">%   factorization_dense_qrt     dense QR of A'      A' = Q*R</span>
0011 <span class="comment">%   factorization_sparse_chol   sparse Cholesky     q*A*q' = L*L'</span>
0012 <span class="comment">%   factorization_sparse_lu     sparse LU           p*A*q = L*U</span>
0013 <span class="comment">%   factorization_sparse_qr     sparse QR of A      (A*q)'*(A*q) = R'*R</span>
0014 <span class="comment">%   factorization_sparse_qrt    sparse QR of A'     (p*A)*(p*A)' = R'*R</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% The abstract class provides these functions:</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%   disp (F)                abstract, displays the factorization</span>
0019 <span class="comment">%   x = mldivide (F,b)      x = A\b using the factorization F</span>
0020 <span class="comment">%   x = mrdivide (b,F)      x = A\b using the factorization F</span>
0021 <span class="comment">%   F = inverse (F)         flags F as the factorization of inv(A)</span>
0022 <span class="comment">%   S = double (F)          returns F as a matrix (A or inv(A))</span>
0023 <span class="comment">%   e = end (F,k,n)         for use in subsref</span>
0024 <span class="comment">%   [m n] = size (F,k)      size(A)</span>
0025 <span class="comment">%   x = mtimes (y,z)        A*b, inv(A)*b, b*A, or b*inv(A)</span>
0026 <span class="comment">%   C = subsref (F,ij)      return components of F, A, or inv(A)</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% The mldivide and mrdivide functions are supported by methods specific</span>
0029 <span class="comment">% to each kind factorization (mldivide_subclass and mrdivide_subclass).</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% The factorization_dense_chol also supports plus and minus (an interface</span>
0032 <span class="comment">% to cholupdate).</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% See also factorization_dense_chol, factorization_dense_lu,</span>
0035 <span class="comment">%    factorization_dense_qr, factorization_dense_qrt,</span>
0036 <span class="comment">%    factorization_sparse_chol, factorization_sparse_lu,</span>
0037 <span class="comment">%    factorization_sparse_qr, factorization_sparse_qrt</span>
0038 
0039 <span class="comment">% Copyright 2009, Timothy A. Davis, University of Florida</span>
0040 
0041     properties (SetAccess = protected)
0042         <span class="comment">% The abstract class holds a QR, LU, Cholesky factorization:</span>
0043         A = [ ] ;           <span class="comment">% a copy of the input matrix</span>
0044         L = [ ] ;           <span class="comment">% L factor for LU and sparse Cholesky</span>
0045         U = [ ] ;           <span class="comment">% U factor for LU</span>
0046         Q = [ ] ;           <span class="comment">% Q factor for dense QR</span>
0047         R = [ ] ;           <span class="comment">% R factor for QR or dense Cholesky</span>
0048         p = [ ] ;           <span class="comment">% sparse row permutation matrix</span>
0049         q = [ ] ;           <span class="comment">% sparse column permutation matrix</span>
0050         is_inverse = false ;<span class="comment">% F represents the factorization of A or inv(A)</span>
0051     <span class="keyword">end</span>
0052 
0053     methods (Abstract)
0054         disp (F) ;
0055         x = mldivide_subclass (F, b) ;
0056         x = mrdivide_subclass (b, F) ;
0057     <span class="keyword">end</span>
0058 
0059     methods
0060 
0061         <span class="keyword">function</span> x = <a href="#_sub1" class="code" title="subfunction x = mldivide (F,b,is_inverse)">mldivide</a> (F,b,is_inverse)
0062             <span class="comment">%MLDIVIDE x = A\b using the factorization F = factorize(A)</span>
0063             <span class="comment">%</span>
0064             <span class="comment">% Example</span>
0065             <span class="comment">%   F = factorize(A) ;</span>
0066             <span class="comment">%   x = F\b ;               % same as x = A\b</span>
0067             <span class="comment">%</span>
0068             <span class="comment">% See also factorize.</span>
0069             <span class="keyword">if</span> (nargin &lt; 3)
0070                 is_inverse = F.is_inverse ;
0071             <span class="keyword">end</span>
0072             <span class="keyword">if</span> (is_inverse)
0073                 <span class="comment">% x=inverse(A)\b is a double inverse, so it becomes x=A*b</span>
0074                 x = F.A*b ;
0075             <span class="keyword">else</span>
0076                 <span class="comment">% x=A\b using the factorization-specific method</span>
0077                 x = mldivide_subclass (F, b) ;
0078             <span class="keyword">end</span>
0079         <span class="keyword">end</span>
0080 
0081         <span class="keyword">function</span> x = <a href="#_sub2" class="code" title="subfunction x = mrdivide (b,F,is_inverse)">mrdivide</a> (b,F,is_inverse)
0082             <span class="comment">%MRDIVIDE x = b/A using the factorization F = factorize(A)</span>
0083             <span class="comment">%</span>
0084             <span class="comment">% Example</span>
0085             <span class="comment">%   F = factorize(A) ;</span>
0086             <span class="comment">%   x = b/F ;               % same as x=b/A</span>
0087             <span class="comment">%</span>
0088             <span class="comment">% See also factorize.</span>
0089             <span class="keyword">if</span> (nargin &lt; 3)
0090                 is_inverse = F.is_inverse ;
0091             <span class="keyword">end</span>
0092             <span class="keyword">if</span> (is_inverse)
0093                 <span class="comment">% x=b/inverse(A) is a double inverse, so it becomes x=b*A</span>
0094                 x = b*F.A ;
0095             <span class="keyword">else</span>
0096                 <span class="comment">% x=b/A using the factorization-specific method</span>
0097                 x = mrdivide_subclass (b, F) ;
0098             <span class="keyword">end</span>
0099         <span class="keyword">end</span>
0100 
0101         <span class="keyword">function</span> F = <a href="#_sub3" class="code" title="subfunction F = inverse (F)">inverse</a> (F)
0102             <span class="comment">%INVERSE &quot;inverts&quot; F by flagging it as factorization of inv(A)</span>
0103             <span class="comment">%</span>
0104             <span class="comment">% Example</span>
0105             <span class="comment">%</span>
0106             <span class="comment">%   F = factorize (A) ;</span>
0107             <span class="comment">%   S = inverse (F) ;</span>
0108             <span class="comment">%</span>
0109             <span class="comment">% See also factorize.</span>
0110             F.is_inverse = ~(F.is_inverse) ;
0111         <span class="keyword">end</span>
0112 
0113         <span class="keyword">function</span> S = <a href="#_sub4" class="code" title="subfunction S = double (F)">double</a> (F)
0114             <span class="comment">%DOUBLE returns the factorization as a matrix, A or inv(A)</span>
0115             <span class="comment">%</span>
0116             <span class="comment">% Example</span>
0117             <span class="comment">%   F = factorize (A) ;         % factorizes A</span>
0118             <span class="comment">%   C = double(F) ;             % C = A</span>
0119             <span class="comment">%   S = inv (A)                 % the explicit inverse</span>
0120             <span class="comment">%   S = double (inverse (A))    % same as S=inv(A)</span>
0121             <span class="comment">%</span>
0122             <span class="comment">% See also factorize.</span>
0123             ij.type = <span class="string">'()'</span> ;
0124             ij.subs = {<span class="string">':'</span>,<span class="string">':'</span>} ;
0125             S = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (F, ij) ;   <span class="comment">% let factorize.subsref do all the work</span>
0126         <span class="keyword">end</span>
0127 
0128         <span class="keyword">function</span> e = end (F,k,n)
0129             <span class="comment">%END returns index of last item for use in subsref</span>
0130             <span class="comment">%</span>
0131             <span class="comment">% Example</span>
0132             <span class="comment">%   S = inverse (A) ;   % factorized representation of inv(A)</span>
0133             <span class="comment">%   S (:,end)           % the last column of inv(A),</span>
0134             <span class="comment">%                       % or pinv(A) if A is rectangular</span>
0135             <span class="comment">%</span>
0136             <span class="comment">% See also factorize.</span>
0137             <span class="keyword">if</span> (n == 1)
0138                 e = numel (F.A) ;   <span class="comment">% # of elements, for linear indexing</span>
0139             <span class="keyword">else</span>
0140                 e = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F,k) ;    <span class="comment">% # of rows or columns in A or pinv(A)</span>
0141             <span class="keyword">end</span>
0142         <span class="keyword">end</span>
0143 
0144         <span class="keyword">function</span> [m n] = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F,k)
0145             <span class="comment">%SIZE returns the size of the matrix F.A in the factorization F</span>
0146             <span class="comment">%</span>
0147             <span class="comment">% Example</span>
0148             <span class="comment">%   F = factorize (A)</span>
0149             <span class="comment">%   size(F)                 % same as size (A)</span>
0150             <span class="comment">%</span>
0151             <span class="comment">% See also factorize.</span>
0152             <span class="keyword">if</span> (F.is_inverse)
0153                 <span class="comment">% swap the dimensions to match pinv(A)</span>
0154                 <span class="keyword">if</span> (nargout &gt; 1)
0155                     [n m] = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F.A) ;
0156                 <span class="keyword">else</span>
0157                     m = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F.A) ;
0158                     m = m ([2 1]) ;
0159                 <span class="keyword">end</span>
0160             <span class="keyword">else</span>
0161                 <span class="keyword">if</span> (nargout &gt; 1)
0162                     [m n] = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F.A) ;
0163                 <span class="keyword">else</span>
0164                     m = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (F.A) ;
0165                 <span class="keyword">end</span>
0166             <span class="keyword">end</span>
0167             <span class="keyword">if</span> (nargin &gt; 1)
0168                 m = m (k) ;
0169             <span class="keyword">end</span>
0170         <span class="keyword">end</span>
0171 
0172         <span class="keyword">function</span> x = <a href="#_sub7" class="code" title="subfunction x = mtimes (y,z)">mtimes</a> (y,z)
0173             <span class="comment">%MTIMES A*b, inv(A)*b, b*A, or b*inv(A)</span>
0174             <span class="comment">%</span>
0175             <span class="comment">% Example</span>
0176             <span class="comment">%   S = inverse (A) ;   % factorized representation of inv(A)</span>
0177             <span class="comment">%   x = S*b ;           % same as x=A\b.  Does not use inv(A)</span>
0178             <span class="comment">%</span>
0179             <span class="comment">% See also factorize.</span>
0180             <span class="keyword">if</span> (isobject (y))
0181                 <span class="keyword">if</span> (y.is_inverse)
0182                     x = <a href="#_sub1" class="code" title="subfunction x = mldivide (F,b,is_inverse)">mldivide</a> (y,z,0) ;  <span class="comment">% x = inv(A)*b via x = A\b</span>
0183                 <span class="keyword">else</span>
0184                     x = y.A * z ;           <span class="comment">% x = A*b</span>
0185                 <span class="keyword">end</span>
0186             <span class="keyword">else</span>
0187                 <span class="keyword">if</span> (z.is_inverse)
0188                     x = <a href="#_sub2" class="code" title="subfunction x = mrdivide (b,F,is_inverse)">mrdivide</a> (y,z,0) ;  <span class="comment">% x = b*inv(A) via x = b/A</span>
0189                 <span class="keyword">else</span>
0190                     x = y * z.A ;           <span class="comment">% x = b*A</span>
0191                 <span class="keyword">end</span>
0192             <span class="keyword">end</span>
0193         <span class="keyword">end</span>
0194 
0195         <span class="keyword">function</span> C = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (F,ij)
0196             <span class="comment">%SUBSREF A(i,j) or (i,j)th entry of inv(A) if F is inverted.</span>
0197             <span class="comment">% Otherwise, explicit entries in the inverse are computed.</span>
0198             <span class="comment">% This method also extracts the contents of F (A, L, U, Q, R,</span>
0199             <span class="comment">% p, q, and is_inverse).</span>
0200             <span class="comment">%</span>
0201             <span class="comment">% Example</span>
0202             <span class="comment">%   F = factorize(A)</span>
0203             <span class="comment">%   F(1,2)              % same as A(1,2)</span>
0204             <span class="comment">%   F.L                 % L factor of the factorization of A</span>
0205             <span class="comment">%   S = inverse(A)</span>
0206             <span class="comment">%   S(1,2)              % the (1,2) entry of inv(A), but only</span>
0207             <span class="comment">%                       % computes % the 2nd column of inv(A)</span>
0208             <span class="comment">%                       % via backslash.</span>
0209             <span class="comment">%</span>
0210             <span class="comment">% See also factorize.</span>
0211 
0212             <span class="keyword">switch</span> (ij(1).type)
0213 
0214                 <span class="keyword">case</span> <span class="string">'.'</span>
0215 
0216                     <span class="comment">% F.U usage: extract one of the matrices from F</span>
0217                     assert (length (ij) &lt;= 2, <span class="keyword">...</span>
0218                         <span class="string">'Improper index matrix reference.'</span>) ;
0219 
0220                     <span class="keyword">switch</span> ij(1).subs
0221                         <span class="keyword">case</span> <span class="string">'A'</span>
0222                             C = F.A ;
0223                         <span class="keyword">case</span> <span class="string">'L'</span>
0224                             C = F.L ;
0225                         <span class="keyword">case</span> <span class="string">'U'</span>
0226                             C = F.U ;
0227                         <span class="keyword">case</span> <span class="string">'Q'</span>
0228                             C = F.Q ;
0229                         <span class="keyword">case</span> <span class="string">'R'</span>
0230                             C = F.R ;
0231                         <span class="keyword">case</span> <span class="string">'p'</span>
0232                             C = F.p ;
0233                         <span class="keyword">case</span> <span class="string">'q'</span>
0234                             C = F.q ;
0235                         <span class="keyword">case</span> <span class="string">'is_inverse'</span>
0236                             C = F.is_inverse ;
0237                         <span class="keyword">otherwise</span>
0238                             error (<span class="keyword">...</span>
0239                             <span class="string">'Reference to non-existent field ''%s''.'</span>, <span class="keyword">...</span>
0240                             ij(1).subs) ;
0241                     <span class="keyword">end</span>
0242 
0243                     <span class="comment">% F.U(2,3) usage, return U(2,3)</span>
0244                     <span class="keyword">if</span> (length (ij) &gt; 1)
0245                         C = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (C, ij (2)) ;
0246                     <span class="keyword">end</span>
0247 
0248                 <span class="keyword">case</span> <span class="string">'()'</span>
0249 
0250                     <span class="comment">% F(2,3) usage, return A(2,3) or the (2,3) of inv(A).</span>
0251                     assert (length (ij) == 1, <span class="keyword">...</span>
0252                         <span class="string">'Improper index matrix reference.'</span>) ;
0253                     A = F.A ;
0254                     <span class="keyword">if</span> (F.is_inverse)
0255                         <span class="comment">% requesting explicit entries of the inverse</span>
0256                         assert (length (ij.subs) == 2, <span class="keyword">...</span>
0257                             <span class="string">'Linear indexing of inverse not supported.'</span>) ;
0258                         [m n] = <a href="#_sub6" class="code" title="subfunction [m n] = size (F,k)">size</a> (A) ;
0259                         ilen = length (ij.subs {1}) ;
0260                         <span class="keyword">if</span> (strcmp (ij.subs {1}, <span class="string">':'</span>))
0261                             ilen = n ;
0262                         <span class="keyword">end</span>
0263                         jlen = length (ij.subs {2}) ;
0264                         <span class="keyword">if</span> (strcmp (ij.subs {2}, <span class="string">':'</span>))
0265                             jlen = m ;
0266                         <span class="keyword">end</span>
0267                         j = ij ;
0268                         j.subs {1} = <span class="string">':'</span> ;
0269                         i = ij ;
0270                         i.subs {2} = <span class="string">':'</span> ;
0271                         <span class="keyword">if</span> (jlen &lt;= ilen)
0272                             <span class="comment">% compute cols S(:,j) of the inverse S=inv(A)</span>
0273                             <span class="keyword">if</span> (issparse (A))
0274                                 I = speye (m) ;
0275                             <span class="keyword">else</span>
0276                                 I = eye (m) ;
0277                             <span class="keyword">end</span>
0278                             C = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (<a href="#_sub1" class="code" title="subfunction x = mldivide (F,b,is_inverse)">mldivide</a> (F, <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (I,j), 0),i);
0279                         <span class="keyword">else</span>
0280                             <span class="comment">% compute rows S(i,:) of the inverse S=inv(A)</span>
0281                             <span class="keyword">if</span> (issparse (A))
0282                                 I = speye (n) ;
0283                             <span class="keyword">else</span>
0284                                 I = eye (n) ;
0285                             <span class="keyword">end</span>
0286                             C = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (<a href="#_sub2" class="code" title="subfunction x = mrdivide (b,F,is_inverse)">mrdivide</a> (<a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (I,i), F, 0),j);
0287                         <span class="keyword">end</span>
0288                     <span class="keyword">else</span>
0289                         <span class="comment">% F is not inverted, so just return A(i,j)</span>
0290                         C = <a href="#_sub8" class="code" title="subfunction C = subsref (F,ij)">subsref</a> (A, ij) ;
0291                     <span class="keyword">end</span>
0292 
0293                 <span class="keyword">case</span> <span class="string">'{}'</span>
0294                     
0295                     error (<span class="keyword">...</span>
0296                     <span class="string">'Cell contents reference from a non-cell array object.'</span>) ;
0297             <span class="keyword">end</span>
0298         <span class="keyword">end</span>
0299     <span class="keyword">end</span>
0300 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>