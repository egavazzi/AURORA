<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of cbunits</title>
  <meta name="keywords" content="cbunits">
  <meta name="description" content="CBUNITS   Adds units (and ISU prefixes) to the colorbar ticklabels.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html AURORA --><!-- ../menu.html tools --><!-- menu.html cm_and_cb_utilities -->
<h1>cbunits
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>CBUNITS   Adds units (and ISU prefixes) to the colorbar ticklabels.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function CBH = cbunits(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">CBUNITS   Adds units (and ISU prefixes) to the colorbar ticklabels.

   SYNTAX:
           cbunits �C             % Just an example for celsius degrees.
           cbunits �C prefix      % Uses ISU's prefix instead of 'x 10^y'.
           cbunits �C nospace     % Do not add a space before the unit.
           cbunits �C off
           cbunits(H,'�C',...)
     CBH = cbunits(...);

   INPUTS:
     UNITS - Units to be added in the current COLORBAR tick labels. May be
             a string or a cell of strings if several colorbars are used.
     H     - Use this colorbar(s) handle(s) (or peer axes (see COLORBAR)
             or figure handle(s)) instead of the current one.
             DEFAULT: gca (uses the current one or creates one)
     '...' - String optional inputs as follows:
              ------------------------------------------------------------
               OPTION       DESCRIPTION
              ------------------------------------------------------------
               'prefix'     Uses International System Units' prefixes.
                            Like 'M' (mega), 'd' (deci), 'p' (pico),
                            instead of the small scientific notation text
                            'x10^6', 'x10^-2', 'x10^-12', respectively.
               'mili'       Uses this specific ISU's prefix. Others are
                            'mega', 'kilo', 'deci', 'nano', etc. Is not
                            recommended to use this functionality.
               'nospace'    Avoids adding an extra space to the unit. That
                            is '3�C' instead of the default '3 �C'. Is not
                            recommended to use this functionality.
               'off'        Undoes previous use of CBUNITS.
              ------------------------------------------------------------

   OUTPUTS (all optional):
     CBH   - Returns the colorbar handle(s).
             DEFAULT: Not returned if not required.
           - Ticklabels modified on the colorbar of the current axes or
             the one(s) specified by CBH.

   DESCRIPTION:
     This function adds units to the current colorbar, by writting them
     after the highest ticklabel.

     When a scientific notation is required, MATLAB put it in a small text
     like 'x10^6', this function will add it in the unit as '�F/1e6', for
     example; or as 'M�F' if 'prefix' was used.

   NOTE:
     * Optional inputs use its DEFAULT value when not given or [].
     * Optional outputs may or not be called.
     * When more than one colorbar handle is given or founded and a single
       UNITS string is given, it is applied to all of them.
     * If not COLORBAR is found on the H handle(s), it creates one on each
       of the axes.
     * Use a cell of strings for UNITS when more than one colorbar handles
       are given in order to give to each one their proper units. This
       also works when the handles are founded but the units order is
       confusing and not recommended.
     * Once applied, CAXIS shouldn't be used.
     * To use just the 'prefix' option without units use '1' like in:
         &gt;&gt; cbunits 1 prefix

   EXAMPLE: (COLORMAP with MEGAWATTS units)
       contour(peaks(30)*1e7)
       cbunits W prefix

   SEE ALSO:
     COLORBAR
     and
     <a href="cblabel.html" class="code" title="function CBLH = cblabel(varargin)">CBLABEL</a>, <a href="cbhandle.html" class="code" title="function CBH = cbhandle(varargin)">CBHANDLE</a>, <a href="cbfreeze.html" class="code" title="function CBH = cbfreeze(varargin)">CBFREEZE</a> by Carlos Vargas
     ticks http://www.mathworks.com/matlabcentral/fileexchange


   ---
   MFILE:   <a href="cbunits.html" class="code" title="function CBH = cbunits(varargin)">cbunits</a>.m
   VERSION: 4.3 (Jun 17, 2014) (&lt;a href=&quot;matlab:web('http://www.mathworks.com/matlabcentral/fileexchange/authors/11258')&quot;&gt;download&lt;/a&gt;)
   MATLAB:  8.2.0.701 (R2013b)
   AUTHOR:  Carlos Adrian Vargas Aguilera (MEXICO)
   CONTACT: nubeobscura@hotmail.com</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="cbhandle.html" class="code" title="function CBH = cbhandle(varargin)">cbhandle</a>	CBHANDLE   Gets the handle of current colorbar or its peer axes.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function CBH = cbunits(varargin)</a>
0002 <span class="comment">%CBUNITS   Adds units (and ISU prefixes) to the colorbar ticklabels.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%   SYNTAX:</span>
0005 <span class="comment">%           cbunits �C             % Just an example for celsius degrees.</span>
0006 <span class="comment">%           cbunits �C prefix      % Uses ISU's prefix instead of 'x 10^y'.</span>
0007 <span class="comment">%           cbunits �C nospace     % Do not add a space before the unit.</span>
0008 <span class="comment">%           cbunits �C off</span>
0009 <span class="comment">%           cbunits(H,'�C',...)</span>
0010 <span class="comment">%     CBH = cbunits(...);</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   INPUTS:</span>
0013 <span class="comment">%     UNITS - Units to be added in the current COLORBAR tick labels. May be</span>
0014 <span class="comment">%             a string or a cell of strings if several colorbars are used.</span>
0015 <span class="comment">%     H     - Use this colorbar(s) handle(s) (or peer axes (see COLORBAR)</span>
0016 <span class="comment">%             or figure handle(s)) instead of the current one.</span>
0017 <span class="comment">%             DEFAULT: gca (uses the current one or creates one)</span>
0018 <span class="comment">%     '...' - String optional inputs as follows:</span>
0019 <span class="comment">%              ------------------------------------------------------------</span>
0020 <span class="comment">%               OPTION       DESCRIPTION</span>
0021 <span class="comment">%              ------------------------------------------------------------</span>
0022 <span class="comment">%               'prefix'     Uses International System Units' prefixes.</span>
0023 <span class="comment">%                            Like 'M' (mega), 'd' (deci), 'p' (pico),</span>
0024 <span class="comment">%                            instead of the small scientific notation text</span>
0025 <span class="comment">%                            'x10^6', 'x10^-2', 'x10^-12', respectively.</span>
0026 <span class="comment">%               'mili'       Uses this specific ISU's prefix. Others are</span>
0027 <span class="comment">%                            'mega', 'kilo', 'deci', 'nano', etc. Is not</span>
0028 <span class="comment">%                            recommended to use this functionality.</span>
0029 <span class="comment">%               'nospace'    Avoids adding an extra space to the unit. That</span>
0030 <span class="comment">%                            is '3�C' instead of the default '3 �C'. Is not</span>
0031 <span class="comment">%                            recommended to use this functionality.</span>
0032 <span class="comment">%               'off'        Undoes previous use of CBUNITS.</span>
0033 <span class="comment">%              ------------------------------------------------------------</span>
0034 <span class="comment">%</span>
0035 <span class="comment">%   OUTPUTS (all optional):</span>
0036 <span class="comment">%     CBH   - Returns the colorbar handle(s).</span>
0037 <span class="comment">%             DEFAULT: Not returned if not required.</span>
0038 <span class="comment">%           - Ticklabels modified on the colorbar of the current axes or</span>
0039 <span class="comment">%             the one(s) specified by CBH.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%   DESCRIPTION:</span>
0042 <span class="comment">%     This function adds units to the current colorbar, by writting them</span>
0043 <span class="comment">%     after the highest ticklabel.</span>
0044 <span class="comment">%</span>
0045 <span class="comment">%     When a scientific notation is required, MATLAB put it in a small text</span>
0046 <span class="comment">%     like 'x10^6', this function will add it in the unit as '�F/1e6', for</span>
0047 <span class="comment">%     example; or as 'M�F' if 'prefix' was used.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">%   NOTE:</span>
0050 <span class="comment">%     * Optional inputs use its DEFAULT value when not given or [].</span>
0051 <span class="comment">%     * Optional outputs may or not be called.</span>
0052 <span class="comment">%     * When more than one colorbar handle is given or founded and a single</span>
0053 <span class="comment">%       UNITS string is given, it is applied to all of them.</span>
0054 <span class="comment">%     * If not COLORBAR is found on the H handle(s), it creates one on each</span>
0055 <span class="comment">%       of the axes.</span>
0056 <span class="comment">%     * Use a cell of strings for UNITS when more than one colorbar handles</span>
0057 <span class="comment">%       are given in order to give to each one their proper units. This</span>
0058 <span class="comment">%       also works when the handles are founded but the units order is</span>
0059 <span class="comment">%       confusing and not recommended.</span>
0060 <span class="comment">%     * Once applied, CAXIS shouldn't be used.</span>
0061 <span class="comment">%     * To use just the 'prefix' option without units use '1' like in:</span>
0062 <span class="comment">%         &gt;&gt; cbunits 1 prefix</span>
0063 <span class="comment">%</span>
0064 <span class="comment">%   EXAMPLE: (COLORMAP with MEGAWATTS units)</span>
0065 <span class="comment">%       contour(peaks(30)*1e7)</span>
0066 <span class="comment">%       cbunits W prefix</span>
0067 <span class="comment">%</span>
0068 <span class="comment">%   SEE ALSO:</span>
0069 <span class="comment">%     COLORBAR</span>
0070 <span class="comment">%     and</span>
0071 <span class="comment">%     CBLABEL, CBHANDLE, CBFREEZE by Carlos Vargas</span>
0072 <span class="comment">%     ticks http://www.mathworks.com/matlabcentral/fileexchange</span>
0073 <span class="comment">%</span>
0074 <span class="comment">%</span>
0075 <span class="comment">%   ---</span>
0076 <span class="comment">%   MFILE:   cbunits.m</span>
0077 <span class="comment">%   VERSION: 4.3 (Jun 17, 2014) (&lt;a href=&quot;matlab:web('http://www.mathworks.com/matlabcentral/fileexchange/authors/11258')&quot;&gt;download&lt;/a&gt;)</span>
0078 <span class="comment">%   MATLAB:  8.2.0.701 (R2013b)</span>
0079 <span class="comment">%   AUTHOR:  Carlos Adrian Vargas Aguilera (MEXICO)</span>
0080 <span class="comment">%   CONTACT: nubeobscura@hotmail.com</span>
0081 
0082 <span class="comment">%   REVISIONS:</span>
0083 <span class="comment">%   1.0      Released. (Aug 21, 2008)</span>
0084 <span class="comment">%   2.0      Minor changes. Added 'clear' option and CBHANDLE dependency.</span>
0085 <span class="comment">%            (Jun 08, 2009)</span>
0086 <span class="comment">%   3.0      Fixed bug when inserting units on lower tick and ticklabel</span>
0087 <span class="comment">%            justification. Added SPACE option. (Sep 30, 2009)</span>
0088 <span class="comment">%   4.0      Eliminated the 'clear' option. Changed SPACE logical option to</span>
0089 <span class="comment">%            string 'nospace'. Included several options for scientiic</span>
0090 <span class="comment">%            notation, like 'prefix' (for auto notation) or 'kilo', 'mega',</span>
0091 <span class="comment">%            etc. (Jun 05, 2014)</span>
0092 <span class="comment">%   4.1      If no unit is given, sets scientific notation like 'eN'</span>
0093 <span class="comment">%            instead of MATLAB's 'x10N'. Forces all labels to have the same</span>
0094 <span class="comment">%            number of decimals. (Jun 14, 2014)</span>
0095 <span class="comment">%   4.2      Fixed several bugs with 'log' scale. (Jun 15, 2014)</span>
0096 <span class="comment">%   4.3      Fixed small bug with '1' unit. (Jun 17, 2014)</span>
0097 
0098 <span class="comment">%   DISCLAIMER:</span>
0099 <span class="comment">%   cbunits.m is provided &quot;as is&quot; without warranty of any kind, under the</span>
0100 <span class="comment">%   revised BSD license.</span>
0101 
0102 <span class="comment">%   Copyright (c) 2008-2014 Carlos Adrian Vargas Aguilera</span>
0103 
0104 
0105 <span class="comment">% INPUTS CHECK-IN</span>
0106 <span class="comment">% -------------------------------------------------------------------------</span>
0107 
0108 <span class="comment">% Sets defaults:</span>
0109 UNITS   = <span class="string">''</span>;
0110 SPACE   = true;
0111 PREFIX  = {<span class="string">''</span>,[]};
0112 OFF     = false;
0113 H       = get(get(0,<span class="string">'CurrentFigure'</span>),<span class="string">'CurrentAxes'</span>);
0114 
0115 <span class="comment">% Extra parameters:</span>
0116 EXP     = <span class="string">'e'</span>;    <span class="comment">% Letter for exponential notation: 'e' or 'E'.</span>
0117 FORCE   = 1==1;   <span class="comment">% All labels with the same decimals (Version 4.1)</span>
0118 
0119 <span class="comment">% Constants:</span>
0120 mu      = char(181); <span class="comment">% For helvetica FONT!</span>
0121 prepow  = [-24:3:-3 -2 -1 1 2 3:3:24];
0122 prestr  = <span class="string">'yzafpnmmcddhkMGTPEZY'</span>;
0123 
0124 <span class="comment">% Anonymous definitions:</span>
0125 numsubs = @(x,ind,val) <span class="keyword">...</span><span class="comment"> % Numerical substitution, x(ind) = val</span>
0126     subsasgn( x, struct( <span class="string">'type'</span>, <span class="string">'()'</span>, <span class="string">'subs'</span>, {{ind}}), val) + 0;
0127 oom     = @(x) <span class="keyword">...</span><span class="comment">         % Order of magnitud of x</span>
0128     numsubs( floor(log10( abs(x))),         x==0,   0) + <span class="keyword">...</span>
0129     numsubs(       zeros(size(x)) , ~isfinite(x), NaN);
0130 sig     = @(x) <span class="keyword">...</span><span class="comment">         % Significant digits on x (Version 4.1)</span>
0131     bsxfun( @(y,sigy) min( numsubs( sigy, sigy==0, Inf), <span class="keyword">...</span>
0132     cell2mat( regexp( arrayfun( @(sigz,z) sprintf( <span class="string">'%1.*e'</span>, <span class="keyword">...</span>
0133     min(sigz,15)-1, z), numsubs( sigy, isnan(sigy), 1), y, <span class="string">'Uni'</span>, <span class="keyword">...</span>
0134     false), <span class="string">'((\d|\.)0*e[\+-][\d]{1,3})|(NaN|[-]?Inf)$'</span>)) ) - 1, <span class="keyword">...</span>
0135     abs(x), oom(x)-oom(eps(x)));
0136 pre     = @(x) <span class="keyword">...</span><span class="comment">         % Precision of x</span>
0137     oom(x) - sig(x) + 1;
0138 sliceit = @(x,n) arrayfun(@(sind) x(1:sind),<span class="keyword">...</span>
0139     regexp(x,[<span class="string">'(?&lt;='</span> x(1:n-1) <span class="string">'.*).'</span>]),<span class="string">'Uni'</span>,false);
0140 
0141 <span class="comment">% Checks inputs/outputs number:</span>
0142 assert(nargin&lt;=4, <span class="string">'CVARGAS:cbunits:tooManyInputs'</span>,<span class="keyword">...</span>
0143     <span class="string">'At most 4 inputs are allowed.'</span>)
0144 assert(nargout&lt;=1,<span class="string">'CVARGAS:cbunits:tooManyOutputs'</span>,<span class="keyword">...</span>
0145     <span class="string">'At most 1 output is allowed.'</span>)
0146 
0147 <span class="comment">% Reads H:</span>
0148 <span class="keyword">if</span> nargin &amp;&amp; ~isempty(varargin{1}) &amp;&amp; <span class="keyword">...</span>
0149         all(reshape(ishandle(varargin{1}),[],1))
0150     H = varargin{1};
0151     varargin(1) = [];
0152 <span class="keyword">end</span>
0153 
0154 <span class="comment">% Reads UNITS:</span>
0155 <span class="keyword">if</span> ~isempty(varargin) &amp;&amp; (ischar(varargin{1}) || iscellstr(varargin{1}))
0156     UNITS = varargin{1};
0157     varargin(1) = [];
0158 <span class="keyword">end</span>
0159 
0160 <span class="comment">% Reads optional inputs:</span>
0161 <span class="keyword">while</span> ~isempty(varargin)
0162     <span class="keyword">if</span> ~ischar(varargin{1}) || (numel(varargin{1})~=size(varargin{1},2))
0163         varargin(1) = [];
0164         <span class="keyword">continue</span>
0165     <span class="keyword">end</span>
0166     <span class="keyword">switch</span> lower(varargin{1})
0167         <span class="keyword">case</span> sliceit(<span class="string">'off'</span>,1)
0168             OFF    = true;
0169         <span class="keyword">case</span> sliceit(<span class="string">'nospace'</span>,2)
0170             SPACE  = false;
0171         <span class="keyword">case</span> sliceit(<span class="string">'prefix'</span>,2)
0172             PREFIX = {<span class="string">'prefix'</span>,[]};
0173         <span class="keyword">case</span> sliceit(<span class="string">'yotta'</span>,3)
0174             PREFIX = {<span class="string">'Y'</span>,1e24};
0175         <span class="keyword">case</span> sliceit(<span class="string">'zetta'</span>,3)
0176             PREFIX = {<span class="string">'Z'</span>,1e21};
0177         <span class="keyword">case</span> sliceit(<span class="string">'exa'</span>,1)
0178             PREFIX = {<span class="string">'E'</span>,1e18};
0179         <span class="keyword">case</span> sliceit(<span class="string">'peta'</span>,2)
0180             PREFIX = {<span class="string">'P'</span>,1e15};
0181         <span class="keyword">case</span> sliceit(<span class="string">'tera'</span>,1)
0182             PREFIX = {<span class="string">'T'</span>,1e12};
0183         <span class="keyword">case</span> sliceit(<span class="string">'giga'</span>,1)
0184             PREFIX = {<span class="string">'G'</span>,1e9};
0185         <span class="keyword">case</span> sliceit(<span class="string">'mega'</span>,2)
0186             PREFIX = {<span class="string">'M'</span>,1e6};
0187         <span class="keyword">case</span> sliceit(<span class="string">'kilo'</span>,1)
0188             PREFIX = {<span class="string">'k'</span>,1e3};
0189         <span class="keyword">case</span> sliceit(<span class="string">'hecto'</span>,1)
0190             PREFIX = {<span class="string">'h'</span>,1e2};
0191         <span class="keyword">case</span> sliceit(<span class="string">'deca'</span>,4)
0192             PREFIX = {<span class="string">'da'</span>,1e1};
0193         <span class="keyword">case</span> sliceit(<span class="string">'deci'</span>,4)
0194             PREFIX = {<span class="string">'d'</span>,1e-1};
0195         <span class="keyword">case</span> sliceit(<span class="string">'centi'</span>,1)
0196             PREFIX = {<span class="string">'c'</span>,1e-2};
0197         <span class="keyword">case</span> sliceit(<span class="string">'mili'</span>,3)
0198             PREFIX = {<span class="string">'m'</span>,1e-3};
0199         <span class="keyword">case</span> sliceit(<span class="string">'micro'</span>,3)
0200             PREFIX = {mu,1e-6};
0201         <span class="keyword">case</span> sliceit(<span class="string">'nano'</span>,2)
0202             PREFIX = {<span class="string">'n'</span>,1e-9};
0203         <span class="keyword">case</span> sliceit(<span class="string">'pico'</span>,2)
0204             PREFIX = {<span class="string">'p'</span>,1e-12};
0205         <span class="keyword">case</span> sliceit(<span class="string">'femto'</span>,1)
0206             PREFIX = {<span class="string">'f'</span>,1e-15};
0207         <span class="keyword">case</span> sliceit(<span class="string">'atto'</span>,1)
0208             PREFIX = {<span class="string">'a'</span>,1e-18};
0209         <span class="keyword">case</span> sliceit(<span class="string">'zepto'</span>,3)
0210             PREFIX = {<span class="string">'z'</span>,1e-21};
0211         <span class="keyword">case</span> sliceit(<span class="string">'yocto'</span>,3)
0212             PREFIX = {<span class="string">'y'</span>,1e-24};
0213         <span class="keyword">otherwise</span>
0214             warning(<span class="string">'CAVARGAS:cbunits:UnrecognizedOptionalInput'</span>, <span class="keyword">...</span>
0215                 <span class="string">'Optional input ''%s'' wasn''t recognized'</span>,varargin{1})
0216     <span class="keyword">end</span>
0217     varargin(1) = [];
0218 <span class="keyword">end</span>
0219 
0220 <span class="comment">% Gets colorbar handles or creates them:</span>
0221 CBH  = <a href="cbhandle.html" class="code" title="function CBH = cbhandle(varargin)">cbhandle</a>(H,<span class="string">'force'</span>);
0222 Ncbh = length(CBH);
0223 
0224 <span class="comment">% Forces UNITS as a cell of strings:</span>
0225 <span class="keyword">if</span> ischar(UNITS)
0226     <span class="keyword">if</span> numel(UNITS)~=size(UNITS,2)
0227         error(<span class="string">'CVARGAS:cbunits:IncorrectUnitsString'</span>,<span class="keyword">...</span>
0228             <span class="string">'UNITS string must be a row vector.'</span>)
0229     <span class="keyword">end</span>
0230     <span class="comment">% Same units for all the colorbars:</span>
0231     UNITS = repmat({UNITS},Ncbh,1);
0232 <span class="keyword">elseif</span> iscellstr(UNITS) &amp;&amp; (length(UNITS)==Ncbh)
0233     <span class="comment">% Continue...</span>
0234 <span class="keyword">else</span>
0235     error(<span class="string">'CVARGAS:cbunits:IncorrectInputUnits'</span>,<span class="keyword">...</span>
0236         [<span class="string">'UNITS must be a string or cell of strings of equal size as '</span> <span class="keyword">...</span>
0237         <span class="string">'the colorbar handles: %d.'</span>],Ncbh)
0238 <span class="keyword">end</span>
0239 
0240 
0241 <span class="comment">% -------------------------------------------------------------------------</span>
0242 <span class="comment">% MAIN</span>
0243 <span class="comment">% -------------------------------------------------------------------------</span>
0244 
0245 <span class="comment">% Applies to each colorbar:</span>
0246 <span class="keyword">for</span> icb = 1:Ncbh
0247     
0248     cbh    = double(CBH(icb));
0249     units  = UNITS{icb};
0250     prefix = <span class="string">''</span>;
0251     sufix  = <span class="string">''</span>;
0252     space  = repmat(<span class="string">' '</span>,1,SPACE);
0253     
0254     <span class="comment">% Gets colorbar position and ticks:</span>
0255     XYstr  = <span class="string">'Y'</span>;
0256     ticks  = get(cbh,[XYstr <span class="string">'Tick'</span>]);
0257     <span class="keyword">if</span> isempty(ticks)
0258         XYstr = <span class="string">'X'</span>;
0259         ticks = get(cbh,[XYstr <span class="string">'Tick'</span>]);
0260     <span class="keyword">end</span>
0261     
0262     <span class="comment">% Deletes current labels:</span>
0263     set(cbh,[XYstr <span class="string">'TickLabelMode'</span>],<span class="string">'auto'</span>)
0264     <span class="keyword">if</span> OFF, <span class="keyword">continue</span>, <span class="keyword">end</span>
0265     
0266     <span class="comment">% Gets scale:</span>
0267     islog = strcmp(get(cbh,[XYstr <span class="string">'Scale'</span>]),<span class="string">'log'</span>);
0268     
0269     <span class="comment">% Gets current labels:</span>
0270     labels = get(cbh,[XYstr <span class="string">'TickLabel'</span>]);
0271     
0272     <span class="comment">% Checks for scientific notation:</span>
0273     <span class="keyword">switch</span> PREFIX{1,1}
0274         
0275         <span class="keyword">case</span> {<span class="string">''</span>,<span class="string">'prefix'</span>}
0276 
0277             <span class="comment">% Gets the order of magnitud:</span>
0278             <span class="keyword">if</span> ~islog
0279                 ind = find(ticks~=0,1);
0280                 ord = oom(ticks(ind)/str2double(labels(ind,:)));
0281                 <span class="keyword">if</span> ord~=0 <span class="comment">% Fixed bug 4.0 version</span>
0282                     <span class="keyword">if</span> isempty(PREFIX{1,1})
0283                         
0284                         <span class="keyword">if</span> isempty(units)
0285                             <span class="comment">% Adds the scientific notation to the unit like</span>
0286                             <span class="comment">% 'e...': (Version 4.1)</span>
0287                             <span class="keyword">if</span> strcmp(units,<span class="string">'1'</span>) <span class="comment">% (Version 4.3)</span>
0288                                 units = <span class="string">''</span>;
0289                             <span class="keyword">end</span>
0290                             prefix = sprintf(<span class="string">'%s%d'</span>,EXP,ord); 
0291                         <span class="keyword">else</span>
0292                             <span class="comment">% Adds the scientific notation to the unit like</span>
0293                             <span class="comment">% 'UNIT/1e...':</span>
0294                             sufix = sprintf(<span class="string">'/1%s%d'</span>,EXP,ord);
0295                         <span class="keyword">end</span>
0296                         labels = ticks(:)/10^ord;
0297                     <span class="keyword">else</span>
0298                         
0299                         <span class="comment">% Adds the scientific notation as IS prefix like</span>
0300                         <span class="comment">% 'M...':</span>
0301                         [~,ind] = min(abs(prepow-ord));
0302                         prenum = prepow(ind);
0303                         <span class="keyword">switch</span> prenum
0304                             <span class="keyword">case</span> 1
0305                                 prefix = <span class="string">'da'</span>;
0306                             <span class="keyword">case</span> -6
0307                                 prefix = mu;
0308                             <span class="keyword">otherwise</span>
0309                                 prefix = prestr(ind);
0310                         <span class="keyword">end</span>
0311                         labels = ticks(:)/10^prenum;
0312                         
0313                     <span class="keyword">end</span>
0314                 <span class="keyword">end</span>
0315             <span class="keyword">elseif</span> strcmp(units,<span class="string">'1'</span>) <span class="comment">% (Version 4.2)</span>
0316                 units = <span class="string">''</span>; 
0317             <span class="keyword">end</span>
0318             
0319         <span class="keyword">otherwise</span>
0320 
0321             <span class="comment">% Uses specific IS prefix:</span>
0322             <span class="keyword">if</span> strcmp(units,<span class="string">'1'</span>) <span class="comment">% (Version 4.1)</span>
0323                 units = <span class="string">''</span>; 
0324             <span class="keyword">end</span>
0325             prefix = PREFIX{1,1};
0326             labels = ticks(:)/PREFIX{1,2};   
0327             
0328     <span class="keyword">end</span>
0329     
0330     <span class="comment">% Changes labels from numeric to char: (Version 4.1)</span>
0331     <span class="keyword">if</span> FORCE
0332         <span class="comment">% All labels with the same decimals:</span>
0333         <span class="keyword">if</span> ischar(labels)
0334             labels = ticks(:);
0335         <span class="keyword">end</span>
0336         fmt = <span class="string">''</span>;
0337         <span class="keyword">if</span> islog <span class="comment">% (Version 4.2)</span>
0338             labels = log10(labels);
0339             fmt = <span class="string">'1e'</span>;
0340         <span class="keyword">end</span>
0341         ndec   = abs(min(min(pre(labels(labels~=0))),0));
0342         fmt    = sprintf(<span class="string">'%s%%.%df'</span>,fmt,ndec);
0343         labels = num2str(labels,fmt);
0344     <span class="keyword">elseif</span> ~ischar(labels) || islog
0345         fmt = <span class="string">''</span>;
0346         <span class="keyword">if</span> islog
0347             labels = log10(ticks);
0348             fmt = <span class="string">'1e'</span>;
0349         <span class="keyword">end</span>
0350         <span class="comment">% Integers without decimals:</span>
0351         ndec   = abs(min(pre(labels),0.*labels));
0352         fmt    = [sprintf(<span class="string">'%s%%.'</span>,fmt), <span class="keyword">...</span>
0353             strjoin( arrayfun( @(x) sprintf( <span class="string">'%d'</span>, x), <span class="keyword">...</span>
0354             ndec, <span class="string">'Uni'</span>, false)', [<span class="string">'f\\n'</span> fmt <span class="string">'%.'</span>]), <span class="string">'f'</span>];
0355         labels = num2str(labels,fmt);
0356     <span class="keyword">end</span>
0357     
0358     <span class="comment">% Looks where to put the units, at the first label or the last one:</span>
0359     Nt  = size(labels,1);
0360     loc = Nt; <span class="comment">% Fixed bug 3.0 version</span>
0361     <span class="keyword">if</span> strcmp(get(cbh,[XYstr <span class="string">'Dir'</span>]),<span class="string">'reverse'</span>) <span class="comment">% (Version 4.1)</span>
0362         loc = 1;
0363     <span class="keyword">end</span>
0364     
0365     <span class="comment">% Adds prefix units and sufix with the units:</span>
0366     Nu = length(units);
0367     Ne = length(space);
0368     Ns = length(sufix);
0369     Np = length(prefix);
0370     labels = [strjust(labels,<span class="string">'right'</span>) repmat(<span class="string">' '</span>,Nt,Ne+Np+Nu+Ns)];
0371     labels(loc,end-Ne-Np-Nu-Ns+1:end) = [space prefix units sufix];
0372     
0373     <span class="comment">% Gets labels' justification:</span>
0374     JUST = <span class="string">'center'</span>;
0375     <span class="keyword">if</span> strcmp(XYstr,<span class="string">'Y'</span>) <span class="comment">% Fixed bug 3.0 version</span>
0376         <span class="keyword">if</span> strcmp(get(cbh,[XYstr <span class="string">'AxisLocation'</span>]),<span class="string">'right'</span>)
0377             JUST = <span class="string">'left'</span>;
0378         <span class="keyword">else</span>
0379             JUST = <span class="string">'right'</span>;
0380         <span class="keyword">end</span>
0381     <span class="keyword">end</span>
0382     
0383     <span class="comment">% Sets labels on the colormap:</span>
0384     set(cbh,[XYstr <span class="string">'TickLabel'</span>],strjust(labels,JUST))
0385     
0386 <span class="keyword">end</span> <span class="comment">% MAIN LOOP</span>
0387 
0388 
0389 <span class="comment">% OUTPUTS CHECK-OUT</span>
0390 <span class="comment">% -------------------------------------------------------------------------</span>
0391 
0392 <span class="comment">% Sets output:</span>
0393 <span class="keyword">if</span> ~nargout
0394     clear CBH
0395 <span class="keyword">end</span>
0396 
0397 <span class="keyword">end</span>
0398 
0399 <span class="comment">% [EOF] CBUNITS.M by Carlos A. Vargas A.</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>