<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of O_e_2nd_dist</title>
  <meta name="keywords" content="O_e_2nd_dist">
  <meta name="description" content="O_e_2nd_dist - 2nd:ary electron energy spectra for ionisation of O.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html Data_electron -->
<h1>O_e_2nd_dist
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>O_e_2nd_dist - 2nd:ary electron energy spectra for ionisation of O.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function Xs = O_e_2nd_dist(Es,E0in,Eionization,s_or_c) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> O_e_2nd_dist - 2nd:ary electron energy spectra for ionisation of O.

 Calling:
  Xs = O_e_2nd_dist(Es,Ep)
 Input:
  Es - energy of secondar electrons,
  Ep - energy of primary electrons,
  extra_args - argument used to select calculation of integrated
               electron spectra between Es(i1) and Es(i1+1)
 Output:
  Xs - spectra of secondary electrons

 NOTE: Unnormalized!
 
 Source: Itikawa and Ichimura 1990</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/setup4etrptd10streams.html" class="code" title="">setup4etrptd10streams</a>	% Set-up script for Examples in time-dependent electron transport</li><li><a href="../../AURORA/sup-scripts/Loop_finalRun_PnL_flickering10beams.html" class="code" title="">Loop_finalRun_PnL_flickering10beams</a>	% Batch-processing-script for FAB-flickering aurora</li><li><a href="../../AURORA/sup-scripts/Loop_first_example_AURORA.html" class="code" title="">Loop_first_example_AURORA</a>	% Example-script for using AURORA the time-dependent electron-transport code</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function Xs = O_e_2nd_dist(Es,E0in,Eionization,s_or_c)</a>
0002 <span class="comment">% O_e_2nd_dist - 2nd:ary electron energy spectra for ionisation of O.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Calling:</span>
0005 <span class="comment">%  Xs = O_e_2nd_dist(Es,Ep)</span>
0006 <span class="comment">% Input:</span>
0007 <span class="comment">%  Es - energy of secondar electrons,</span>
0008 <span class="comment">%  Ep - energy of primary electrons,</span>
0009 <span class="comment">%  extra_args - argument used to select calculation of integrated</span>
0010 <span class="comment">%               electron spectra between Es(i1) and Es(i1+1)</span>
0011 <span class="comment">% Output:</span>
0012 <span class="comment">%  Xs - spectra of secondary electrons</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% NOTE: Unnormalized!</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Source: Itikawa and Ichimura 1990</span>
0017 
0018 <span class="comment">% Equation and parameters from M.H. Rees [1989]</span>
0019 <span class="comment">% $$$ I = 13.62; % (eV) Ionization energy</span>
0020 <span class="comment">% $$$</span>
0021 <span class="comment">% $$$ W = Es + I;</span>
0022 <span class="comment">% $$$</span>
0023 <span class="comment">% $$$ Xs = (W).^(-1).*exp(-W/31.5-339*exp(-W/2.49)).* ...</span>
0024 <span class="comment">% $$$      log(max(0,real((Ep.^.5+(Ep-W).^.5)./(Ep.^.5-(Ep-W).^.5))));</span>
0025 <span class="comment">% $$$</span>
0026 <span class="comment">% $$$ Xs(Es&gt;(Ep+I)/2) = 0;</span>
0027 <span class="comment">% $$$ Xs(~isfinite(Xs)) = 0;</span>
0028 <span class="comment">% $$$</span>
0029 <span class="comment">% $$$ if ~all(isreal(Xs))</span>
0030 <span class="comment">% $$$   keyboard</span>
0031 <span class="comment">% $$$ end</span>
0032 
0033 
0034 <span class="comment">%% Equation from Ittikawa</span>
0035 
0036 <span class="keyword">persistent</span> Q E4Q Eionizations
0037 
0038 <span class="keyword">if</span> isempty(Q)
0039   <span class="keyword">try</span>
0040     load CascadingSpecOionization.mat Q E4Q Eionizations
0041   <span class="keyword">end</span>
0042 <span class="keyword">end</span>
0043 
0044 E_parameters = [100, 200, 500, 1000 2000];
0045 B_p =         [7.18 4.97 2.75 1.69 1.02]*1e-22; <span class="comment">%</span>
0046 A_p =         [12.6 13.7 14.1 14.0 13.7];
0047 
0048 Ep = E0in;
0049 <span class="keyword">if</span> min(E_parameters)&lt;Ep &amp; Ep &lt; max(E_parameters)
0050   A = interp1(E_parameters,A_p,Ep);
0051   B = interp1(E_parameters,B_p,Ep);
0052 <span class="keyword">elseif</span> Ep &lt;= min(E_parameters)
0053   A = A_p(1);
0054   B = B_p(1);
0055 <span class="keyword">else</span>
0056   A = A_p(end);
0057   B = B_p(end);
0058 <span class="keyword">end</span>
0059 Eionizations = [13.618
0060                 16.9
0061                 18.6
0062                 28.5];
0063 A = A*1.25;
0064 
0065 <span class="keyword">if</span> isempty(Q) || ~all(E4Q(1:min(numel(Es),numel(E4Q)))==Es(1:min(numel(Es),numel(E4Q))))
0066   E4Q = Es;
0067   Q = zeros(numel(Es),numel(Es),numel(Eionization));
0068   dE = diff(Es);dE = dE([1:<span class="keyword">end</span>,end]);
0069   disp(<span class="string">'Pre-calculating all energy-degradations for e - O-ionizing collisions.'</span>)
0070   disp(<span class="string">'This will take a bit of time.'</span>)
0071   disp([<span class="string">'Starting at: '</span>,datestr(now,<span class="string">'HH:MM:SS'</span>)])
0072   <span class="keyword">for</span> i3 = numel(Eionizations):-1:1,
0073     iLim = find(Es&gt;Eionizations(i3),1,<span class="string">'first'</span>);
0074     <span class="keyword">for</span> i2 = iLim:numel(Es),
0075       <span class="keyword">if</span> min(E_parameters)&lt;Ep &amp; Ep &lt; max(E_parameters)
0076         A = interp1(E_parameters,A_p,Es(i2));
0077         B = interp1(E_parameters,B_p,Es(i2));
0078       <span class="keyword">elseif</span> Es(i2) &lt;= min(E_parameters)
0079         A = A_p(1);
0080         B = B_p(1);
0081       <span class="keyword">else</span>
0082         A = A_p(end);
0083         B = B_p(end);
0084       <span class="keyword">end</span>
0085       iHalf = find(Es&lt;(Es(i2)-Eionizations(i3))/2,1,<span class="string">'last'</span>);
0086       <span class="keyword">for</span> i1 = iHalf:(i2-1),
0087         Eprime = [Es(i2),Es(i2)+dE(i2)];
0088         Edeg = [Es(i1),Es(i1)+dE(i1)];
0089         fun = @(E1,E2) B./( 1 + ((E2-Eionizations(i3)-E1)/A).^(5/3) );
0090         Emin = @(E) max(Eprime(1),E+Eionizations(i3));           
0091         Edegmax = min(Es(i1)+dE(i1),Es(i2)+dE(i2)-Eionizations(i3));
0092         <span class="keyword">if</span> Edegmax &gt; Es(i1)
0093           Q(i2,i1,i3) = integral2(fun,Es(i1),Edegmax,Emin,Eprime(end));
0094         <span class="keyword">end</span>
0095       <span class="keyword">end</span>
0096     <span class="keyword">end</span>
0097   <span class="keyword">end</span>
0098   save CascadingSpecOionization.mat Q E4Q Eionizations
0099 <span class="keyword">end</span>
0100 
0101 <span class="keyword">if</span> nargin == 2
0102   <span class="comment">% Differential cross-section</span>
0103   Xs = B./( 1 + (Es/A).^(5/3) ).*(Es &lt; (Ep-13.618)/2 ); <span class="comment">% Should</span>
0104                                                         <span class="comment">% be 5/3</span>
0105                                                         <span class="comment">% not (6/3)</span>
0106   
0107 <span class="keyword">else</span>
0108   
0109   [DE,iLevel] = min(abs(Eionization-Eionizations));
0110   [DE2,iPrimary] = min(abs(E4Q-E0in));
0111   Xs = Q(iPrimary,1:numel(Es),iLevel);
0112   
0113 <span class="keyword">end</span>
0114 
0115 <span class="comment">% Xs = 3*( log(2*A^(2/3) + (5^.5-1)*Es^(1/3)*A^(1/3) + 2*Es^(2/3) ) /(5-5^(3/2))/A^(2/3) + log(2*A^(2/3) + (-5^.5-1)*Es^(1/3)*A^(1/3) + 2*Es^(2/3) ) /(5+5^(3/2))/A^(2/3) + log(A^(1/3)+x^(1/3))/(5*A^(2/3)) - 2 * atan( (A*(5^.5-1) + 4*Es)/( (2*5^.5 +10)^.5*A^(1/3) ) )/(5^.5 * ( 2*5^.5 + 10 )*A^(2/3)) + 2 * atan( (A*(-5^.5-1) + 4*Es)/( (-2*5^.5 +10)^.5*A^(1/3) ) )/(5^.5 * ( -2*5^.5 + 10 )*A^(2/3)))*A^(5/3)*B;</span>
0116 
0117 <span class="comment">% Xs = -A*B*( atan(Es(1:end)/A) - atan(Es([2:end,end])/A) );</span>
0118 
0119 <span class="comment">% $$$ if 0</span>
0120 <span class="comment">% $$$   % That was nothing, look at THIS! ~7340 chars!</span>
0121 <span class="comment">% $$$   ert =</span>
0122 <span class="comment">% $$$     @(E1,E2,X,a,b)E1.^(1.0./3.0).*a.^(5.0./3.0).*b.*(-2.999999999999999)+E1.^(2.0./3.0).*a.^(4.0./3.0).*b.*7.840355822033438e-17+E2.^(1.0./3.0).*a.^(5.0./3.0).*b.*2.999999999999999-E2.^(2.0./3.0).*a.^(4.0./3.0).*b.*7.840355822033438e-17+a.^2.*b.*log((E1+X).^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32-1.236041985183381e32i)).*(4.854101966249677e-1+3.526711513754837e-1i)+a.^2.*b.*log((E1+X).^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32+1.236041985183381e32i)).*(4.854101966249677e-1-3.526711513754837e-1i)+a.^2.*b.*log((E2+X).^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32-1.236041985183381e32i)).*(-4.854101966249677e-1-3.526711513754837e-1i)+a.^2.*b.*log((E2+X).^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32+1.236041985183381e32i)).*(-4.854101966249677e-1+3.526711513754837e-1i)+a.^2.*b.*log((E1+X).^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30-2.091459287371088e31i)).*(-1.854101966249686e-1+5.706339097770922e-1i)+a.^2.*b.*log((E1+X).^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30+2.091459287371088e31i)).*(-1.854101966249686e-1-5.706339097770922e-1i)+a.^2.*b.*log((E2+X).^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30-2.091459287371088e31i)).*(1.854101966249686e-1-5.706339097770922e-1i)+a.^2.*b.*log((E2+X).^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30+2.091459287371088e31i)).*(1.854101966249686e-1+5.706339097770922e-1i)-a.^2.*b.*log((E1+X).^(1.0./3.0)+a.^(1.0./3.0)).*(3.0./5.0)+a.^2.*b.*log((E2+X).^(1.0./3.0)+a.^(1.0./3.0)).*(3.0./5.0)+a.^2.*b.*log(E1.^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32-1.236041985183381e32i)).*(-4.854101966249677e-1-3.526711513754837e-1i)+a.^2.*b.*log(E1.^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32+1.236041985183381e32i)).*(-4.854101966249677e-1+3.526711513754837e-1i)+a.^2.*b.*log(E2.^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32-1.236041985183381e32i)).*(4.854101966249677e-1+3.526711513754837e-1i)+a.^2.*b.*log(E2.^(1.0./3.0).*2.102880227706607e32+a.^(1.0./3.0).*(-1.701265841349703e32+1.236041985183381e32i)).*(4.854101966249677e-1-3.526711513754837e-1i)+a.^2.*b.*log(E1.^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30-2.091459287371088e31i)).*(1.854101966249686e-1-5.706339097770922e-1i)+a.^2.*b.*log(E1.^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30+2.091459287371088e31i)).*(1.854101966249686e-1+5.706339097770922e-1i)+a.^2.*b.*log(E2.^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30-2.091459287371088e31i)).*(-1.854101966249686e-1+5.706339097770922e-1i)+a.^2.*b.*log(E2.^(1.0./3.0).*2.199090434202986e31+a.^(1.0./3.0).*(6.795563163361048e30+2.091459287371088e31i)).*(-1.854101966249686e-1-5.706339097770922e-1i)+a.^2.*b.*log(E1.^(1.0./3.0)+a.^(1.0./3.0)).*(3.0./5.0)-a.^2.*b.*log(E2.^(1.0./3.0)+a.^(1.0./3.0)).*(3.0./5.0)-a.^(4.0./3.0).*b.*(E1+X).^(2.0./3.0).*7.840355822033438e-17+a.^(5.0./3.0).*b.*(E1+X).^(1.0./3.0).*2.999999999999999+a.^(4.0./3.0).*b.*(E2+X).^(2.0./3.0).*7.840355822033438e-17-a.^(5.0./3.0).*b.*(E2+X).^(1.0./3.0).*2.999999999999999+X.*a.*b.*log((E1+X).^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1-5.706339097770923e-1i)+X.*a.*b.*log((E1+X).^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1+5.706339097770923e-1i)+X.*a.*b.*log((E2+X).^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1+5.706339097770923e-1i)+X.*a.*b.*log((E2+X).^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1-5.706339097770923e-1i)-E1.*a.*b.*log((E1+X).^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)+E2.*a.*b.*log((E2+X).^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)-X.*a.*b.*log((E1+X).^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)+X.*a.*b.*log((E2+X).^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)+E1.*a.*b.*log(E1.^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1+5.706339097770923e-1i)+E1.*a.*b.*log(E1.^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1-5.706339097770923e-1i)+E2.*a.*b.*log(E2.^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1-5.706339097770923e-1i)+E2.*a.*b.*log(E2.^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1+5.706339097770923e-1i)+E1.*a.*b.*log(E1.^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)-E2.*a.*b.*log(E2.^(1.0./3.0).*8.1e1+a.^(1.0./3.0).*8.1e1).*(3.0./5.0)+E1.*a.*b.*log((E1+X).^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1+3.526711513754839e-1i)+E1.*a.*b.*log((E1+X).^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1-3.526711513754839e-1i)+E2.*a.*b.*log((E2+X).^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1-3.526711513754839e-1i)+E2.*a.*b.*log((E2+X).^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1+3.526711513754839e-1i)+X.*a.*b.*log((E1+X).^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1+3.526711513754839e-1i)+X.*a.*b.*log((E1+X).^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1-3.526711513754839e-1i)+X.*a.*b.*log((E2+X).^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1-3.526711513754839e-1i)+X.*a.*b.*log((E2+X).^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1+3.526711513754839e-1i)+E1.*a.*b.*log((E1+X).^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1-5.706339097770923e-1i)+E1.*a.*b.*log((E1+X).^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(-1.854101966249685e-1+5.706339097770923e-1i)+E2.*a.*b.*log((E2+X).^(1.0./3.0).*(-6.553037654437077e1-4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1+5.706339097770923e-1i)+E2.*a.*b.*log((E2+X).^(1.0./3.0).*(-6.553037654437077e1+4.761060543569036e1i)+a.^(1.0./3.0).*8.1e1).*(1.854101966249685e-1-5.706339097770923e-1i)+E1.*a.*b.*log(E1.^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1-3.526711513754839e-1i)+E1.*a.*b.*log(E1.^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(-4.854101966249684e-1+3.526711513754839e-1i)+E2.*a.*b.*log(E2.^(1.0./3.0).*(1.803628711650741e18-5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1+3.526711513754839e-1i)+E2.*a.*b.*log(E2.^(1.0./3.0).*(1.803628711650741e18+5.550998393024096e18i)+a.^(1.0./3.0).*5.836665117072163e18).*(4.854101966249684e-1-3.526711513754839e-1i)</span>
0123 <span class="comment">% $$$</span>
0124 <span class="comment">% $$$     % This should be the integral:</span>
0125 <span class="comment">% $$$     % \int_0^dE\int_{E(iE)-E(jE+1)+\epsilon}^{E(iE)-E(jE)+\epsilon}P_s(E')dE'd\epsilon</span>
0126 <span class="comment">% $$$     % Which should be the cascading distribution of electrons from</span>
0127 <span class="comment">% $$$     % an energy-bin [E(iE) E(iE) + dE]</span>
0128 <span class="comment">% $$$ end</span>
0129 
0130 
0131 <span class="comment">% $$$ DE dEion Ei Ej Ejp1 X</span>
0132 <span class="comment">% $$$ E1 = (Ei-dEion-Ejp1+X)</span>
0133 <span class="comment">% $$$ E2 = (Ei-dEion-Ej+X)</span>
0134 <span class="comment">% $$$</span>
0135 <span class="comment">% $$$ asd2 = (3*A*B*log(81*((E2+X)/A)^(1/3) + 81))/5 - (3*A*B*log(81* ...</span>
0136 <span class="comment">% $$$                                                   ((E1+X)/A)^(1/3) + 81))/5 + A*B*log(81 - 375*((E1+X)/A)^(1/3)*((3*5^(1/2))/20 - (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20)^3)*((3*5^(1/2))/20 - (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20) + A*B*log(81 - 375*((E1+X)/A)^(1/3)*((3*5^(1/2))/20 + (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20)^3)*((3*5^(1/2))/20 + (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20) - A*B*log(81 - 375*((E2+X)/A)^(1/3)*((3*5^(1/2))/20 - (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20)^3)*((3*5^(1/2))/20 - (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20) - A*B*log(81 - 375*((E2+X)/A)^(1/3)*((3*5^(1/2))/20 + (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20)^3)*((3*5^(1/2))/20 + (3*2^(1/2)*(5^(1/2) - 5)^(1/2))/20 + 3/20) + A*B*log(81 - 375*((E1+X)/A)^(1/3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 - (3*5^(1/2))/20 + 3/20)^3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 - (3*5^(1/2))/20 + 3/20) - A*B*log(375*((E1+X)/A)^(1/3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 + (3*5^(1/2))/20 - 3/20)^3 + 81)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 + (3*5^(1/2))/20 - 3/20) - A*B*log(81 - 375*((E2+X)/A)^(1/3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 - (3*5^(1/2))/20 + 3/20)^3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 - (3*5^(1/2))/20 + 3/20) + A*B*log(375*((E2+X)/A)^(1/3)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 + (3*5^(1/2))/20 - 3/20)^3 + 81)*((3*2^(1/2)*(- 5^(1/2) - 5)^(1/2))/20 + (3*5^(1/2))/20 - 3/20)</span>
0137 <span class="comment">% $$$ for i3 = numel(Eworks):-1:1,</span>
0138 <span class="comment">% $$$   iLim = find(E&gt;Eworks(i3),1,'first')</span>
0139 <span class="comment">% $$$   for i2 = iLim:numel(E),</span>
0140 <span class="comment">% $$$     Ep = E(i2);</span>
0141 <span class="comment">% $$$     if min(E_parameters)&lt;Ep &amp; Ep &lt; max(E_parameters)</span>
0142 <span class="comment">% $$$       A = interp1(E_parameters,A_p,Ep);</span>
0143 <span class="comment">% $$$       B = interp1(E_parameters,B_p,Ep);</span>
0144 <span class="comment">% $$$     elseif Ep &lt;= min(E_parameters)</span>
0145 <span class="comment">% $$$       A = A_p(1);</span>
0146 <span class="comment">% $$$       B = B_p(1);</span>
0147 <span class="comment">% $$$     else</span>
0148 <span class="comment">% $$$       A = A_p(end);</span>
0149 <span class="comment">% $$$       B = B_p(end);</span>
0150 <span class="comment">% $$$     end</span>
0151 <span class="comment">% $$$     iHalf = find(E&lt;(E(i2)-Eworks(i3))/2,1,'last');</span>
0152 <span class="comment">% $$$     for i1 = iHalf:min(numel(E),(i2+1)),</span>
0153 <span class="comment">% $$$       Eprime = linspace(E(i2),E(i2)+dE(i2),10);</span>
0154 <span class="comment">% $$$       Efine = linspace(E(i1),E(i1)+dE(i1),10);</span>
0155 <span class="comment">% $$$       %[E1,E2] = meshgrid(Efine,Eprime);</span>
0156 <span class="comment">% $$$       fun = @(E1,E2)heaviside(E2-Eworks(i3)-E1).*B./( 1 + ((E2-Eworks(i3)-E1)/A).^(5/3));</span>
0157 <span class="comment">% $$$       % fun = @(x,y) interp2(E1,E2,f,x,y);</span>
0158 <span class="comment">% $$$       Q(i2,i1) = integral2(fun,E(i1),E(i1)+dE(i1),Eprime(1),Eprime(end));</span>
0159 <span class="comment">% $$$     end</span>
0160 <span class="comment">% $$$     if rem(i2,10) == 0</span>
0161 <span class="comment">% $$$       disp(sprintf('%d: %s',i2,datestr(now,'HH:MM:SS')))</span>
0162 <span class="comment">% $$$     end</span>
0163 <span class="comment">% $$$   end</span>
0164 <span class="comment">% $$$   Eall = E;</span>
0165 <span class="comment">% $$$   save load CascadingSpecOionization.mat Q Eall Eworks</span>
0166 <span class="comment">% $$$</span>
0167 <span class="comment">% $$$ end</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>