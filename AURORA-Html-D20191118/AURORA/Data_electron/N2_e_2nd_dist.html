<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of N2_e_2nd_dist</title>
  <meta name="keywords" content="N2_e_2nd_dist">
  <meta name="description" content="N2_e_2nd_dist - 2nd:ary electron energy spectra ionisation of N2.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html Data_electron -->
<h1>N2_e_2nd_dist
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>N2_e_2nd_dist - 2nd:ary electron energy spectra ionisation of N2.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function Xs = N2_e_2nd_dist(Es,E0in,Eionization,s_or_c) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> N2_e_2nd_dist - 2nd:ary electron energy spectra ionisation of N2.

 Calling:
  Xs = N2_e_2nd_dist(Es,E0in)
 Input:
  Es   - energy of secondar electrons (eV), double array [1 x nEs]
  E0in - energy of primary electrons (eV), double scalar
  Eionization - ionization threshold (eV), double scalar so that
         we can properly calculate the energy-distribution of
         degrading electrons due to ionization to excited N2+ and
         dissociative ionizations
  s_or_c - spectra of secondary electrons or cascading electrons
 Output:
  Xs - spectra of secondary electrons, double array [1 x nEs]
 
 NOTE: Unnormalized! So that the user have to calculate the total
 ionization by normalizing Xs by its sum and scale with the
 ionizing cross-section, the N2 density and the electron flux.
 
 Equation from Ittikawa 1986 J. Phys. Chem. Ref. Data</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/setup4etrptd10streams.html" class="code" title="">setup4etrptd10streams</a>	% Set-up script for Examples in time-dependent electron transport</li><li><a href="../../AURORA/sup-scripts/Loop_finalRun_PnL_flickering10beams.html" class="code" title="">Loop_finalRun_PnL_flickering10beams</a>	% Batch-processing-script for FAB-flickering aurora</li><li><a href="../../AURORA/sup-scripts/Loop_first_example_AURORA.html" class="code" title="">Loop_first_example_AURORA</a>	% Example-script for using AURORA the time-dependent electron-transport code</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function Xs = N2_e_2nd_dist(Es,E0in,Eionization,s_or_c)</a>
0002 <span class="comment">% N2_e_2nd_dist - 2nd:ary electron energy spectra ionisation of N2.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Calling:</span>
0005 <span class="comment">%  Xs = N2_e_2nd_dist(Es,E0in)</span>
0006 <span class="comment">% Input:</span>
0007 <span class="comment">%  Es   - energy of secondar electrons (eV), double array [1 x nEs]</span>
0008 <span class="comment">%  E0in - energy of primary electrons (eV), double scalar</span>
0009 <span class="comment">%  Eionization - ionization threshold (eV), double scalar so that</span>
0010 <span class="comment">%         we can properly calculate the energy-distribution of</span>
0011 <span class="comment">%         degrading electrons due to ionization to excited N2+ and</span>
0012 <span class="comment">%         dissociative ionizations</span>
0013 <span class="comment">%  s_or_c - spectra of secondary electrons or cascading electrons</span>
0014 <span class="comment">% Output:</span>
0015 <span class="comment">%  Xs - spectra of secondary electrons, double array [1 x nEs]</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% NOTE: Unnormalized! So that the user have to calculate the total</span>
0018 <span class="comment">% ionization by normalizing Xs by its sum and scale with the</span>
0019 <span class="comment">% ionizing cross-section, the N2 density and the electron flux.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Equation from Ittikawa 1986 J. Phys. Chem. Ref. Data</span>
0022 
0023 <span class="comment">%  Copyright � Bjorn Gustavsson 20190408, bjorn.gustavsson@uit.no</span>
0024 <span class="comment">%  This is free software, licensed under GNU GPL version 2 or later</span>
0025 
0026 
0027 <span class="keyword">persistent</span> Q E4Q Eionizations
0028 <span class="keyword">if</span> isempty(Q)
0029   <span class="keyword">try</span>
0030     <span class="comment">% TODO: In med &quot;data-bas-s� �er tidigare k�ningar</span>
0031     <span class="comment">% CascadeDir =</span>
0032     <span class="comment">% Cfiles = dir(CascadeDir)</span>
0033     <span class="comment">% For iF = 1:</span>
0034     <span class="comment">%</span>
0035     load CascadingSpecN2ionization.mat Q E4Q Eionizations
0036     <span class="comment">% Cmp with E4Q with Es</span>
0037   <span class="keyword">end</span>
0038 <span class="keyword">end</span>
0039 
0040 <span class="comment">%% Precalculation of degrading spectra</span>
0041 E_hat = 11.4;
0042 <span class="keyword">if</span> isempty(Q) || ~all(E4Q(1:min(numel(Es),numel(E4Q)))==Es(1:min(numel(Es),numel(E4Q))))
0043   <span class="comment">% ~all(E4Q(1:numel(Es))==Es)</span>
0044   Eionizations = [15.581
0045                   16.73
0046                   18.75
0047                   24
0048                   42];
0049   Q = zeros(numel(Es),numel(Es),numel(Eionizations));
0050   E4Q = Es;
0051   dE = diff(Es);dE = dE([1:<span class="keyword">end</span>,end]);
0052   disp(<span class="string">'Pre-calculating all energy-degradations for e - N2-ionizing collisions.'</span>)
0053   disp(<span class="string">'This will take a bit of time.'</span>)
0054   disp([<span class="string">'Starting at: '</span>,datestr(now,<span class="string">'HH:MM:SS'</span>)])
0055   <span class="keyword">for</span> i3 = numel(Eionizations):-1:1,
0056     iLim = find(Es&gt;Eionizations(i3),1,<span class="string">'first'</span>);
0057     <span class="keyword">for</span> i2 = iLim:numel(Es),
0058       iHalf = find(Es&lt;(Es(i2)-Eionizations(i3))/2,1,<span class="string">'last'</span>);
0059       <span class="keyword">for</span> i1 = iHalf:(i2-1),
0060         Eprime = [Es(i2),Es(i2)+dE(i2)];
0061         Edeg = [Es(i1),Es(i1)+dE(i1)];
0062         fun =  @(E1,E2) 1./((E2-Eionizations(i3)-E1).^2+E_hat^2);
0063         <span class="comment">% Lower boundary of primary electrons, This correctly</span>
0064         <span class="comment">% accounts for the limit when Edeg(i1+1) is larger than</span>
0065         <span class="comment">% Eprimary(i2+1)-Eionizations(i3), cutting a corner off the</span>
0066         <span class="comment">% [Ei1 - Ei1+dEi1] x [Ei2 + dEi2] square we're integrating over.</span>
0067         Emin = @(E) max(Eprime(1),E+Eionizations(i3));
0068         <span class="comment">% Correct upper Edeg integration limit, this cuts the</span>
0069         <span class="comment">% region into a triangle when needed</span>
0070         Edegmax = min(Es(i1)+dE(i1),Es(i2)+dE(i2)-Eionizations(i3));
0071         <span class="comment">% This if-condition just makes sure that we have the</span>
0072         <span class="comment">% physically meaningful limits, i.e. we integrate in</span>
0073         <span class="comment">% increasing Edeg - which is not otherwise guaranteed.</span>
0074         <span class="keyword">if</span> Edegmax &gt; Es(i1)
0075           <span class="comment">% Edges(i1) = {Emin,Edegmax};</span>
0076           Q(i2,i1,i3) = integral2(fun,Es(i1),Edegmax,Emin,Eprime(end));
0077         <span class="keyword">end</span>
0078       <span class="keyword">end</span>
0079     <span class="keyword">end</span>
0080     disp([<span class="string">'Done with level '</span>,num2str(i3),<span class="string">' at: '</span>,datestr(now,<span class="string">'HH:MM:SS'</span>)])
0081   <span class="keyword">end</span>
0082   save CascadingSpecN2ionization.mat Q E4Q Eionizations
0083 <span class="keyword">end</span>
0084 
0085 <span class="comment">% $$$         funH = @(E1,E2) heaviside(E2-Eionizations(i3)-E1)./((E2-Eionizations(i3)-E1).^2+E_hat^2);</span>
0086 <span class="comment">% Q2(i2,i1,i3) = integral2(funH,Es(i1),Edegmax,Emin,Eprime(end));</span>
0087 
0088 <span class="keyword">if</span> strcmp(s_or_c,<span class="string">'s'</span>)
0089   <span class="comment">%% Calculating the spectra of secondary electrons</span>
0090   Xs = 1./(E_hat^2+Es.^2).*(Es &lt; (E0in - Eionization)/2 );
0091   
0092 <span class="keyword">else</span>
0093   <span class="comment">%% or extracting the degrading primary electron</span>
0094   [DE,iLevel] = min(abs(Eionization-Eionizations));
0095   [DE2,iPrimary] = min(abs(E4Q-E0in));
0096   Xs = Q(iPrimary,1:numel(Es),iLevel);
0097   
0098 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>