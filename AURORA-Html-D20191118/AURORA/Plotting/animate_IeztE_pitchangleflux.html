<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of animate_IeztE_pitchangleflux</title>
  <meta name="keywords" content="animate_IeztE_pitchangleflux">
  <meta name="description" content="animate_IeztE_pitchangleflux - animation of time-varying electron energy flux">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html Plotting -->
<h1>animate_IeztE_pitchangleflux
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>animate_IeztE_pitchangleflux - animation of time-varying electron energy flux</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut,cxin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> animate_IeztE_pitchangleflux - animation of time-varying electron energy flux
  animate_IeztE_pitchangleflux animates the time-varying electron
  fluxes varying with energy - pitch-angle at four altitudes
  stepping in time. The electron-fluxes are plotted in log-scale
  with polarPcolor in four subplots.

 Calling:
  output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut)
 Input:
  t          - time-scale (s), double array [1 x n_t]
  h_atm      - altitudes (km), double array [n_z x 1]
  E          - energies (eV), double array [1 x n_E]
  Ie_ztE     - electron number-flux, double array [n_z*n_beams,n_t,n_E]
  dE         - energy bin sizes (eV), double array [1 x n_E]
  BeamSA     - solid angle sizes of the beams, [n_beams x 1]
  mu_lims    - beam-boundaries, (cos(theta_b)), [n_beams x 1] or
               [1 x n_beams]
  movieOut   - Optional argument, if MovieName in matlab-supported
               video-format then animate_IeEztE_3DtEofz will attempt
               to write the displayed sequence to a video-file
               with that filename using the VideoWriter
               functionality. See VideoWriter for details. If
               numerical value that is converted to TRUE, a matlab
               movie will be returned.
 Output:
  M     - Matlab-movie with the displayed sequence.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/sup-scripts/make_all_animations.html" class="code" title="">make_all_animations</a>	% Make all animations-script</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut,cxin)</a>
0002 <span class="comment">% animate_IeztE_pitchangleflux - animation of time-varying electron energy flux</span>
0003 <span class="comment">%  animate_IeztE_pitchangleflux animates the time-varying electron</span>
0004 <span class="comment">%  fluxes varying with energy - pitch-angle at four altitudes</span>
0005 <span class="comment">%  stepping in time. The electron-fluxes are plotted in log-scale</span>
0006 <span class="comment">%  with polarPcolor in four subplots.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Calling:</span>
0009 <span class="comment">%  output = animate_IeztE_pitchangleflux(t,h_atm,E,dE,IeZTE,BeamW,mu_lims,iZ,movieOut)</span>
0010 <span class="comment">% Input:</span>
0011 <span class="comment">%  t          - time-scale (s), double array [1 x n_t]</span>
0012 <span class="comment">%  h_atm      - altitudes (km), double array [n_z x 1]</span>
0013 <span class="comment">%  E          - energies (eV), double array [1 x n_E]</span>
0014 <span class="comment">%  Ie_ztE     - electron number-flux, double array [n_z*n_beams,n_t,n_E]</span>
0015 <span class="comment">%  dE         - energy bin sizes (eV), double array [1 x n_E]</span>
0016 <span class="comment">%  BeamSA     - solid angle sizes of the beams, [n_beams x 1]</span>
0017 <span class="comment">%  mu_lims    - beam-boundaries, (cos(theta_b)), [n_beams x 1] or</span>
0018 <span class="comment">%               [1 x n_beams]</span>
0019 <span class="comment">%  movieOut   - Optional argument, if MovieName in matlab-supported</span>
0020 <span class="comment">%               video-format then animate_IeEztE_3DtEofz will attempt</span>
0021 <span class="comment">%               to write the displayed sequence to a video-file</span>
0022 <span class="comment">%               with that filename using the VideoWriter</span>
0023 <span class="comment">%               functionality. See VideoWriter for details. If</span>
0024 <span class="comment">%               numerical value that is converted to TRUE, a matlab</span>
0025 <span class="comment">%               movie will be returned.</span>
0026 <span class="comment">% Output:</span>
0027 <span class="comment">%  M     - Matlab-movie with the displayed sequence.</span>
0028 
0029 
0030 <span class="comment">%   Copyright � 20190506 Bj�n Gustavsson, &lt;bjorn.gustavsson@uit.no&gt;</span>
0031 <span class="comment">%   This is free software, licensed under GNU GPL version 2 or later</span>
0032 
0033 doMovie = 0;
0034 
0035 <span class="keyword">if</span> nargin &gt; 7 &amp;&amp; ~isempty(movieOut)
0036   <span class="keyword">if</span> isstr(movieOut)
0037     <span class="keyword">try</span>
0038       vidObj = VideoWriter(movieOut);
0039       open(vidObj);
0040       doMovie = 1;
0041     <span class="keyword">catch</span>
0042       doMovie = 0;
0043       disp([<span class="string">'Failed to initialize VideoWriter Object for movie: '</span>,movieOut])
0044     <span class="keyword">end</span>
0045   <span class="keyword">elseif</span> movieOut
0046     doMovie = 2;
0047   <span class="keyword">end</span>
0048 <span class="keyword">end</span>
0049 
0050 <span class="keyword">if</span> nargin &lt; 10 || isempty(cxin)
0051   cx2use = ([-5 0]+12.25);
0052 <span class="keyword">else</span>
0053   cx2use = cxin;
0054 <span class="keyword">end</span>
0055 nZ = numel(h_atm);
0056 <span class="comment">%% Extracting electron flux at 4 altitudes</span>
0057 
0058 <span class="keyword">for</span> iz = numel(iZ):-1:1,
0059   Ie_alts{iz} = IeZTE(iZ(iz):nZ:<span class="keyword">end</span>,:,:);
0060 <span class="keyword">end</span>
0061 
0062 <span class="comment">%% Graphics settings:</span>
0063 ftsz = 14;
0064 colormap(parula)
0065 xtxtpos = [0,1.3]; <span class="comment">% Altitude-label above change 1.3 to -1.3 for below</span>
0066 suptpos = [1.1,1.4];
0067 cblpos = [-0.7,-0.3];
0068 
0069 <span class="comment">%% Animationing</span>
0070 <span class="keyword">for</span> it = 1:numel(t),
0071   caxis(cx2use)
0072   clf
0073   <span class="keyword">for</span> ip = 1:4
0074     IePAD{ip}(:,:,it) = squeeze(Ie_alts{5-ip}([1:<span class="keyword">end</span>,end],it,:))./<span class="keyword">...</span>
0075                           (dE(1:size(IeZTE,3))'*BeamW([1:<span class="keyword">end</span>,end]))';
0076     mysubplot(2,2,ip)
0077     polarPcolor(log10(E(1:size(IeZTE,3))),<span class="keyword">...</span>
0078                 acos(mu_lims)*180/pi,<span class="keyword">...</span>
0079                 log10(max(1e7,squeeze(Ie_alts{5-ip}([1:<span class="keyword">end</span>,end],it,:))./<span class="keyword">...</span>
0080                           (dE(1:size(IeZTE,3))'*BeamW([1:<span class="keyword">end</span>,end]))')),<span class="keyword">...</span>
0081                 <span class="string">'Ncircles'</span>,3,<span class="keyword">...</span>
0082                 <span class="string">'Nspokes'</span>,7,<span class="keyword">...</span>
0083                 <span class="string">'Rvals'</span>,[1 2 3],<span class="keyword">...</span>
0084                 <span class="string">'Rticklabel'</span>,{<span class="string">'10^1'</span>,<span class="string">'10^2'</span>,<span class="string">'10^3'</span>});
0085     <span class="keyword">if</span> ip == 1
0086       text(suptpos(1),suptpos(2),sprintf(<span class="string">'time: %4.3f (s)'</span>,t(it)),<span class="string">'fontsize'</span>,ftsz)
0087     <span class="keyword">end</span>
0088     alt_str = sprintf(<span class="string">'z: %2.1f (km)'</span>,h_atm(iZ(5-ip)));
0089     <span class="comment">% text(xtxtpos(1),xtxtpos(2),'height: 610 km','fontsize',ftsz)</span>
0090     text(xtxtpos(1),xtxtpos(2),alt_str,<span class="string">'fontsize'</span>,ftsz)
0091     text(cblpos(1),cblpos(2),<span class="string">'(e^{-1}/m^2/s/ster/eV)'</span>,<span class="string">'rotation'</span>,90)
0092     caxis(cx2use)
0093   <span class="keyword">end</span>
0094   drawnow
0095   <span class="keyword">if</span> doMovie == 1 || doMovie == 2
0096     <span class="keyword">if</span> doMovie == 1
0097       writeVideo(vidObj,getframe(gcf));
0098     <span class="keyword">elseif</span> doMovie == 2
0099       M(it) = getframe(gcf);
0100     <span class="keyword">end</span>
0101   <span class="keyword">end</span>
0102 <span class="keyword">end</span>
0103 
0104 <span class="keyword">if</span> doMovie == 2
0105   output = M;
0106 <span class="keyword">elseif</span> doMovie == 1
0107   output = [];
0108   close(vidObj);
0109 <span class="keyword">else</span>
0110   output = IePAD;
0111 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>