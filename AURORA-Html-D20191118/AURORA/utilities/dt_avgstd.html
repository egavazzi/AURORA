<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of dt_avgstd</title>
  <meta name="keywords" content="dt_avgstd">
  <meta name="description" content="DT_AVGSTD - average (and std) of difference between times in unsynchronised">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html AURORA --><!-- menu.html utilities -->
<h1>dt_avgstd
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>DT_AVGSTD - average (and std) of difference between times in unsynchronised</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> DT_AVGSTD - average (and std) of difference between times in unsynchronised
   sequences, of for example times for extremal values of time-varying
   intensity values. A use-case is given two varying time-series
   with local maxima and minima from a limited period where the
   two time-series does not have the same number of local maxima
   (minima), one time-series might be shifted just so that the
   first, or last, maxima appears just outside the time-period of
   observation. Then this function lines up the two
   non-equal-length sequences with extreme-value-times giving the
   smallest absolute average shift.
 
 Calling:
   [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)
 Input:
  t_ext1 - coordinates of extrema in sequence 1, double array
           [1 x n1] or [n1 x 1] 
  t_ext2 - coordinates of extrema in sequence 1, double array
           [1 x n2] or [n2 x 1]
 Output:
  dtavg - best average difference between the extrema in the sequences
  stddt - standard deviation of the best difference between the
          extrema in the sequences 
  dT    - array with the differences between the best shifted
          sequences 
  t_ext1 and t_ext2 both have to be either column or row-vectors,
  otherwise the new matlab &quot;outer-difference&quot; and &quot;outer-sum&quot;
  behaviour might lead to unintended behaviour.
 
 Example:
   figure
   w = 5;
   t = linspace(0,5,501);           % time-array
   y1 = erf(t) + 0.1*cos(w*t-0.5);  % time-series #1
   y2 = erf(t) + 0.11*cos(w*t+0.5); % time-series #2
   ph = plot(t,[y1;y2]);
   set(ph(1),'color','b'),set(ph(2),'color','r')
   k1 = local_max(y1);              % local maxima time-series #1
   k1(k1==1|k1==numel(y1)) = [];    % but we cut local maxima at
                                    % first and last point
   k2 = local_max(y2);              % local maxima time-series #2
   k2(k2==1|k2==numel(y2)) = [];    % and we cut local maxima at
                                    % first and last point here too
   hold on
   plot(t(k1),y1(k1),'b.',t(k2),y2(k2),'r.','markersize',15)
   [dtavg,stddt,dT] = dt_avgstd(t(k1),t(k2));
   plot(t-dtavg,y2,'r--')
   [dtavg2,stddt2,dT2] = dt_avgstd(t(k1),t(k2)-dtavg);
   disp([dT;dT2]) 

 No argument checks or error-controls, if you want that you have
 to pay me good money.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../AURORA/sup-scripts/combine_n_extract_I_dt_Mm5.html" class="code" title="function [All_I_lambda,It_Mm] = combine_n_extract_I_dt_Mm5(root_dir,RunDirs)">combine_n_extract_I_dt_Mm5</a>	% Collect all optical emissions and the input parameters</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)</a>
0002 <span class="comment">% DT_AVGSTD - average (and std) of difference between times in unsynchronised</span>
0003 <span class="comment">%   sequences, of for example times for extremal values of time-varying</span>
0004 <span class="comment">%   intensity values. A use-case is given two varying time-series</span>
0005 <span class="comment">%   with local maxima and minima from a limited period where the</span>
0006 <span class="comment">%   two time-series does not have the same number of local maxima</span>
0007 <span class="comment">%   (minima), one time-series might be shifted just so that the</span>
0008 <span class="comment">%   first, or last, maxima appears just outside the time-period of</span>
0009 <span class="comment">%   observation. Then this function lines up the two</span>
0010 <span class="comment">%   non-equal-length sequences with extreme-value-times giving the</span>
0011 <span class="comment">%   smallest absolute average shift.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% Calling:</span>
0014 <span class="comment">%   [dtavg,stddt,dT] = dt_avgstd(t_ext1,t_ext2)</span>
0015 <span class="comment">% Input:</span>
0016 <span class="comment">%  t_ext1 - coordinates of extrema in sequence 1, double array</span>
0017 <span class="comment">%           [1 x n1] or [n1 x 1]</span>
0018 <span class="comment">%  t_ext2 - coordinates of extrema in sequence 1, double array</span>
0019 <span class="comment">%           [1 x n2] or [n2 x 1]</span>
0020 <span class="comment">% Output:</span>
0021 <span class="comment">%  dtavg - best average difference between the extrema in the sequences</span>
0022 <span class="comment">%  stddt - standard deviation of the best difference between the</span>
0023 <span class="comment">%          extrema in the sequences</span>
0024 <span class="comment">%  dT    - array with the differences between the best shifted</span>
0025 <span class="comment">%          sequences</span>
0026 <span class="comment">%  t_ext1 and t_ext2 both have to be either column or row-vectors,</span>
0027 <span class="comment">%  otherwise the new matlab &quot;outer-difference&quot; and &quot;outer-sum&quot;</span>
0028 <span class="comment">%  behaviour might lead to unintended behaviour.</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Example:</span>
0031 <span class="comment">%   figure</span>
0032 <span class="comment">%   w = 5;</span>
0033 <span class="comment">%   t = linspace(0,5,501);           % time-array</span>
0034 <span class="comment">%   y1 = erf(t) + 0.1*cos(w*t-0.5);  % time-series #1</span>
0035 <span class="comment">%   y2 = erf(t) + 0.11*cos(w*t+0.5); % time-series #2</span>
0036 <span class="comment">%   ph = plot(t,[y1;y2]);</span>
0037 <span class="comment">%   set(ph(1),'color','b'),set(ph(2),'color','r')</span>
0038 <span class="comment">%   k1 = local_max(y1);              % local maxima time-series #1</span>
0039 <span class="comment">%   k1(k1==1|k1==numel(y1)) = [];    % but we cut local maxima at</span>
0040 <span class="comment">%                                    % first and last point</span>
0041 <span class="comment">%   k2 = local_max(y2);              % local maxima time-series #2</span>
0042 <span class="comment">%   k2(k2==1|k2==numel(y2)) = [];    % and we cut local maxima at</span>
0043 <span class="comment">%                                    % first and last point here too</span>
0044 <span class="comment">%   hold on</span>
0045 <span class="comment">%   plot(t(k1),y1(k1),'b.',t(k2),y2(k2),'r.','markersize',15)</span>
0046 <span class="comment">%   [dtavg,stddt,dT] = dt_avgstd(t(k1),t(k2));</span>
0047 <span class="comment">%   plot(t-dtavg,y2,'r--')</span>
0048 <span class="comment">%   [dtavg2,stddt2,dT2] = dt_avgstd(t(k1),t(k2)-dtavg);</span>
0049 <span class="comment">%   disp([dT;dT2])</span>
0050 <span class="comment">%</span>
0051 <span class="comment">% No argument checks or error-controls, if you want that you have</span>
0052 <span class="comment">% to pay me good money.</span>
0053 
0054 <span class="comment">% Copyright ï¿½ 20190506 B. Gustavsson, &lt;bjorn.gustavsson@uit.no&gt;</span>
0055 <span class="comment">%   This is free software, GPL version 3 or later applies</span>
0056 
0057 dtavg = nan;
0058 stddt = nan;
0059 dT{1} = [];
0060 
0061 <span class="keyword">if</span> isempty(t_ext1) || isempty(t_ext2)
0062   dtavg = nan;
0063   stddt = nan;
0064   dT    = [];
0065 <span class="keyword">else</span>
0066   n1 = numel(t_ext1);
0067   n2 = numel(t_ext2);
0068   dn = n2 - n1;
0069   <span class="keyword">if</span> dn == 0
0070     dT    =     -(t_ext1 - t_ext2);
0071     dtavg = -mean(t_ext1 - t_ext2);
0072     stddt =   std(t_ext1 - t_ext2);
0073   <span class="keyword">elseif</span> dn &lt; 0
0074     dtLevel = inf;
0075     <span class="keyword">for</span> i_shift = 0:abs(dn)
0076       dt_test = abs(mean(t_ext1((1:n2)+i_shift) - t_ext2));
0077       <span class="keyword">if</span> dt_test &lt; dtLevel
0078         dT      =     -(t_ext1((1:n2)+i_shift) - t_ext2);
0079         dtavg   = -mean(t_ext1((1:n2)+i_shift) - t_ext2);
0080         stddt   =   std(t_ext1((1:n2)+i_shift) - t_ext2);
0081         dtLevel = dt_test;
0082       <span class="keyword">end</span>
0083     <span class="keyword">end</span>
0084   <span class="keyword">else</span>
0085     dtLevel = inf;
0086     <span class="keyword">for</span> i_shift = 0:abs(dn)
0087       dt_test = abs(mean(t_ext1 - t_ext2((1:n1)+i_shift)));
0088       <span class="keyword">if</span> dt_test &lt; dtLevel
0089         dT      =     -(t_ext1 - t_ext2((1:n1)+i_shift));
0090         dtavg   = -mean(t_ext1 - t_ext2((1:n1)+i_shift));
0091         stddt   =   std(t_ext1 - t_ext2((1:n1)+i_shift));
0092         dtLevel = dt_test;
0093       <span class="keyword">end</span>
0094     <span class="keyword">end</span>
0095   <span class="keyword">end</span>
0096 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 18-Nov-2019 14:53:30 by <strong>B.&nbsp;Gustavsson</strong> with <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>